(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    223090,       5347]
NotebookOptionsPosition[    221684,       5304]
NotebookOutlinePosition[    222025,       5319]
CellTagsIndexPosition[    221982,       5316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["1. Data adjustment", "Program",
 CellChangeTimes->{{3.739773938935604*^9, 3.739773941558588*^9}, {
  3.7874828578569517`*^9, 3.787482858169478*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Import", " ", "data", " ", "from", " ", 
    RowBox[{"file", ".", " ", "Covert"}], " ", "data", " ", "entries", " ", 
    "to", " ", "real", " ", 
    RowBox[{"numbers", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "\"\<data/dataInitial.xlsx\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"data", ",", "1"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Remove", " ", "the", " ", "empty", " ", 
     RowBox[{"entries", ":", " ", 
      RowBox[{
      "the", " ", "data", " ", "is", " ", "imported", " ", "into", " ", "a", 
       " ", "matrix"}]}]}], ",", " ", 
    RowBox[{
    "so", " ", "empty", " ", "entries", " ", "are", " ", "added", " ", "to", 
     " ", "rows", " ", "corresponding", " ", "to", " ", "shorter", " ", 
     RowBox[{"arches", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"data", "/.", 
    RowBox[{"\"\<\>\"", " ", "\[Rule]", " ", "Nothing"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Only", " ", "keep", " ", "arches", " ", "longer", " ", "than", " ", "25", 
    " ", 
    RowBox[{"filaments", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data25", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], "<", "25"}], ",", " ", "Nothing", 
        ",", " ", "#"}], "]"}], "&"}], "/@", "data"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Function", " ", "for", " ", "replacing", " ", "filaments", " ", "in", 
     " ", "data_", " ", "that", " ", "are", " ", "negative", " ", "for", " ", 
     "pattern", " ", "out", " ", "of", " ", "vector", " ", "patterns_", " ", 
     "with", " ", "0.", " ", "\n", "The", " ", "vector", " ", "patterns_", 
     " ", "is", " ", "a", " ", "list", " ", "of", " ", "length", " ", "7", 
     " ", "of", " ", "type", " ", 
     RowBox[{"{", 
      RowBox[{"1.", ",", 
       RowBox[{"1.1", "."}], ",", "1.2", ",", "1.5", ",", "12.", ",", "13.", 
       ",", "14."}], "}"}]}], ",", " ", 
    RowBox[{
    "including", " ", "all", " ", "occurences", " ", "of", " ", "that", " ", 
     "pattern", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "mixed"}], " ", "or", " ", "half", 
         " ", "patterns"}], ",", " ", "too"}], ")"}], "."}]}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"adjustData", "[", 
     RowBox[{"data_", ",", " ", "patterns_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"forbidden", ",", " ", "dataNew"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"forbidden", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"data", ",", " ", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"#", "===", 
                 RowBox[{"patterns", "[", 
                  RowBox[{"[", "7", "]"}], "]"}]}], ")"}]}], ")"}]}], "&"}]}],
           "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"dataNew", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{"data", "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", " ", "\[Rule]", " ", "0."}], ")"}], "&"}], "/@", 
            "forbidden"}], ")"}]}], ")"}]}], ";", "\n", "\t", 
       RowBox[{"dataNew", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{"dataNew", "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", " ", "\[Rule]", " ", 
               RowBox[{"patterns", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
            "patterns"}], ")"}]}], ")"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "dataNew", "]"}], ";"}]}], "\n", "]"}]}], ";"}],
   "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Adjust", " ", "data", " ", "for", " ", "different", " ", "patterns"}], 
    ",", " ", 
    RowBox[{"using", " ", "the", " ", "adjustData", " ", "function", " ", 
     RowBox[{"above", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"dataPatt", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatt", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"adjustData", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
        "1.", ",", "1.1", ",", "1.2", ",", "1.5", ",", "12.", ",", "13.", ",",
          "14."}], "}"}]}], "]"}], "&"}], "/@", "data25"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatt", "[", 
    RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"adjustData", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
        "2.", ",", "2.1", ",", "2.2", ",", "2.5", ",", "12.", ",", "23.", ",",
          "24."}], "}"}]}], "]"}], "&"}], "/@", "data25"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatt", "[", 
    RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"adjustData", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
        "3.", ",", "3.1", ",", "3.2", ",", "3.5", ",", "13.", ",", "23.", ",",
          "34."}], "}"}]}], "]"}], "&"}], "/@", "data25"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dataPatt", "[", 
     RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"adjustData", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
         "4.", ",", "4.1", ",", "4.2", ",", "4.5", ",", "14.", ",", "24.", 
          ",", "34."}], "}"}]}], "]"}], "&"}], "/@", "data25"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Export", " ", "final", " ", "datasets", " ", "for", " ", "each", " ", 
     "pattern"}], ",", " ", 
    RowBox[{
    "in", " ", "a", " ", "list", " ", "of", " ", "lists", " ", "representing",
      " ", "each", " ", "arch", " ", "with", " ", "corresponding", " ", 
     RowBox[{"pattern", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<data/dataPatterned25_1.csv\>\"", ",", 
    RowBox[{"dataPatt", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<data/dataPatterned25_2.csv\>\"", ",", 
    RowBox[{"dataPatt", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<data/dataPatterned25_3.csv\>\"", ",", 
    RowBox[{"dataPatt", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<data/dataPatterned25_4.csv\>\"", ",", 
     RowBox[{"dataPatt", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"dataPatterned", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dataPatt", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "/.", 
       RowBox[{"\"\<\>\"", " ", "\[Rule]", " ", "Nothing"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatterned", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"dataPatterned", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Take", " ", "the", " ", "left", " ", "8", " ", "filments", " ", "of", " ",
     "each", " ", "branchial", " ", 
    RowBox[{"arch", "/", 
     RowBox[{"row", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatternedLeft", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dataPatterned", "[", 
       RowBox[{"[", 
        RowBox[{"#", ",", ";;", ",", 
         RowBox[{";;", "8"}]}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Take", " ", "the", " ", "right", " ", "8", " ", "filaments", " ", "of", 
    " ", "each", " ", "brancial", " ", 
    RowBox[{"arch", "/", 
     RowBox[{"row", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatternedRight", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dataPatterned", "[", 
       RowBox[{"[", 
        RowBox[{"#", ",", ";;", ",", 
         RowBox[{
          RowBox[{"-", "8"}], ";;"}]}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Remember", " ", "the", " ", "length", " ", "of", " ", "each", " ", "data",
     " ", 
    RowBox[{"set", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataLength", "=", 
    RowBox[{"Length", "[", 
     RowBox[{"dataPatternedLeft", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Reverse", " ", "the", " ", "order", " ", "of", " ", "left", " ", 
     "mini"}], "-", 
    RowBox[{"arches", " ", 
     RowBox[{"s", ".", "t", ".", " ", "have"}], " ", "oldest", " ", 
     "filament", " ", 
     RowBox[{"first", ".", " ", "For"}], " ", "the", " ", "right", " ", 
     "mini"}], "-", 
    RowBox[{
    "arches", " ", "the", " ", "oldest", " ", "filament", " ", "is", " ", 
     "in", " ", "the", " ", "first", " ", "position", " ", "of", " ", "the", 
     " ", 
     RowBox[{"array", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"dataRev", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataRev", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"dataPatternedLeft", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "dataLength", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataRev", "[", 
    RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"dataPatternedLeft", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "dataLength", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataRev", "[", 
    RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"dataPatternedLeft", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "dataLength", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataRev", "[", 
    RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"dataPatternedLeft", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "dataLength", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatternedLeft", "=", "dataRev"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Combine", " ", "the", " ", "data", " ", "set", " ", "containing", " ", 
      "the", " ", "left", " ", "mini"}], "-", 
     RowBox[{"arches", " ", "reversed"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "the", " ", "right", " ", "mini"}], "-", 
     RowBox[{
     "arches", " ", "within", " ", "the", " ", "same", " ", "final", " ", 
      "data", " ", 
      RowBox[{"set", "."}]}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatterned", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"dataPatternedLeft", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
        RowBox[{"dataPatternedRight", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Export", " ", "final", " ", "data", " ", "set"}], ",", " ", 
    RowBox[{"for", " ", "each", " ", 
     RowBox[{"pattern", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"\"\<data/dataPatterned25minirev_\>\"", "<>", 
        RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.csv\>\""}], ",", 
       RowBox[{"dataPatterned", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "4", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
     "cell"}], ",", " ", 
    RowBox[{"so", " ", "it", " ", "is", " ", "only", " ", "performed", " ", 
     RowBox[{"once", "."}]}]}], " ", "*)"}]}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.7397739149677525`*^9, 3.739773920780058*^9}, {
   3.7398554449046707`*^9, 3.739855569625331*^9}, {3.739855683791994*^9, 
   3.7398561533101654`*^9}, {3.739856239577334*^9, 3.7398562533924923`*^9}, {
   3.7402051108657613`*^9, 3.740205124311672*^9}, {3.7801359677176733`*^9, 
   3.7801360125333242`*^9}, {3.78013608457098*^9, 3.7801361124274044`*^9}, {
   3.780137377795498*^9, 3.780137422091801*^9}, {3.780137577208413*^9, 
   3.7801376061615705`*^9}, {3.780137686343614*^9, 3.7801378301667585`*^9}, {
   3.780138015035056*^9, 3.7801380227071314`*^9}, {3.7801383366167946`*^9, 
   3.7801383785435305`*^9}, {3.7801384502079377`*^9, 
   3.7801384592609262`*^9}, {3.7801399726556425`*^9, 
   3.7801399857122765`*^9}, {3.780728709873621*^9, 3.780728724495425*^9}, {
   3.7807287550506954`*^9, 3.7807289681559505`*^9}, {3.7807290072764807`*^9, 
   3.780729145476012*^9}, {3.780729209098913*^9, 3.7807292249615602`*^9}, {
   3.7807292857440586`*^9, 3.7807295230438766`*^9}, {3.7807295683714657`*^9, 
   3.7807296091311293`*^9}, {3.780735030629616*^9, 3.7807350816632223`*^9}, {
   3.780735145785854*^9, 3.7807351730839915`*^9}, {3.784962361254304*^9, 
   3.78496255871541*^9}, {3.7849626192044296`*^9, 3.7849627676808367`*^9}, {
   3.7849628084169226`*^9, 3.7849629748631463`*^9}, {3.784963298731213*^9, 
   3.7849633434748125`*^9}, {3.7849635820560923`*^9, 3.784963592703136*^9}, {
   3.7849636419751587`*^9, 3.784963656638863*^9}, {3.784963744096795*^9, 
   3.78496374467918*^9}, 3.784963867375842*^9, {3.784964273160481*^9, 
   3.7849642942704473`*^9}, {3.784964594871828*^9, 3.784964600074274*^9}, {
   3.787478242620512*^9, 3.787478308670085*^9}}],

Cell["2. Function definitions", "Program",
 CellChangeTimes->{{3.6862992867546096`*^9, 3.6862992880965257`*^9}, {
  3.7807352775981655`*^9, 3.780735280098282*^9}, {3.7874828619352646`*^9, 
  3.787482862263405*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "GENERAL", " ", "FUNCTIONS", " ", "FOR", " ", "DATA", " ", "MANIPULATION", 
    " ", "AND", " ", 
    RowBox[{"QUANTIFICATION", ":"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Function", " ", "that", " ", "computes", " ", "the", " ", "labelling", 
     " ", "efficiency", " ", "from", " ", "the", " ", "data", " ", "set", " ",
      "data_", " ", "for", " ", "pattern", " ", "pattern_.", " ", "\n", 
     "Approximate", " ", "the", " ", "labelling", " ", "efficiency", " ", 
     "for", " ", "each", " ", "pattern"}], ",", " ", 
    RowBox[{
     RowBox[{"by", " ", "combinatorial", " ", 
      RowBox[{"approach", ":", " ", "\n", "probLab"}]}], " ", "=", " ", 
     RowBox[{"nL", "/", "N"}]}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "nL"}], "=", 
     RowBox[{
     "number", " ", "of", " ", "labelled", " ", "oldest", " ", 
      "filaments"}]}], ",", " ", 
    RowBox[{"N", "=", 
     RowBox[{"total", " ", "number", " ", "of", " ", 
      RowBox[{"arches", "."}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getLabelEfficiencyPattern", "[", 
      RowBox[{"data_", ",", " ", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nArcs", ",", "firstFil", ",", "unlabFirstFil", ",", " ", 
         "labFirstFil", ",", " ", "labEfficiency"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"nArcs", " ", "=", " ", 
         RowBox[{"Length", "[", "data", "]"}]}], ";", "\n", "\t", 
        RowBox[{"firstFil", " ", "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"labFirstFil", " ", "=", " ", 
         RowBox[{"Count", "[", 
          RowBox[{"firstFil", ",", 
           RowBox[{"pattern", "*", "1."}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"labEfficiency", " ", "=", " ", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"labFirstFil", "/", "nArcs"}], ",", ".0001"}], "]"}]}], 
        ";", "\n", "\t", 
        RowBox[{"Return", "[", "labEfficiency", "]"}], ";"}]}], "\n", "]"}]}],
     ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Counts", " ", "the", " ", "number", " ", "of", " ", "switches", " ", 
      "nSwitches", " ", "in", " ", "an", " ", "arch", " ", "arc_"}], ",", " ", 
     RowBox[{
      RowBox[{
      "for", " ", "analysing", " ", "data", " ", "with", " ", "pattern", " ", 
       "pattern_", " ", "\n", "   ", "A", " ", "switch", " ", "is", " ", "a", 
       " ", "transition", " ", "1"}], "\[Rule]", 
      RowBox[{
       RowBox[{"0", " ", "or", " ", "0"}], "\[Rule]", 
       RowBox[{
       "1", " ", "within", " ", "the", " ", "binary", " ", "array", " ", 
        "describing", " ", "the", " ", "branchial", " ", 
        RowBox[{"arch", "."}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countSwitches", "[", 
      RowBox[{"arc_", ",", " ", "pattern_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nSwitches", ",", " ", "arcPartitioned"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "partition", " ", "each", " ", "arch", " ", "in", " ", "in", " ", 
          "lists", " ", "of", " ", "2"}], ",", " ", 
         RowBox[{
         "to", " ", "determine", " ", "where", " ", "the", " ", "switches", 
          " ", 
          RowBox[{
          "exist", ".", " ", "\n", "\t", "E", ".", "g", ".", " ", "for"}], "  ", 
          RowBox[{"{", 
           RowBox[{
           "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", 
            ",", "0"}], "}"}]}], ",", " ", 
         RowBox[{"arcPartitioned", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"arcPartitioned", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"arc", ",", "2", ",", "1"}], "]"}]}], ";", "  ", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Count", " ", "the", " ", "switches"}], ",", " ", 
          RowBox[{
           RowBox[{"i", ".", "e", ".", " ", "instances"}], " ", "of", " ", 
           "pairs", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], " ", "and", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], " ", "within", " ", "the", " ", 
           "arcPartitioned", " ", 
           RowBox[{"above", "."}]}]}], " ", "*)"}], " ", "\n", "\t", 
        RowBox[{"nSwitches", " ", "=", " ", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"arcPartitioned", ",", " ", 
            RowBox[{"{", 
             RowBox[{"pattern", ",", "0."}], "}"}]}], "]"}], " ", "+", " ", 
          RowBox[{"Count", "[", 
           RowBox[{"arcPartitioned", ",", " ", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "pattern"}], "}"}]}], "]"}]}]}], ";", "\n", 
        "\t", 
        RowBox[{"Return", "[", "nSwitches", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Applies", " ", "the", " ", "countSwitches", " ", "function", " ", "to", 
     " ", "an", " ", "entire", " ", "dataset"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countSwitchesData", "[", 
      RowBox[{"data_", ",", "pattern_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"countSwitches", "[", 
        RowBox[{"#", ",", "pattern"}], "]"}], "&"}], "/@", "data"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Returns", " ", "the", " ", "number", " ", "of", " ", "labeled", " ", 
      "filaments", " ", "in", " ", "an", " ", "arch"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "entries"}], " ", "=", 
      "1."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countLabeledFilaments", "[", 
      RowBox[{"arc_", ",", "pattern_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"Count", "[", 
       RowBox[{"arc", ",", "pattern"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Applies", " ", "previous", " ", "function", " ", "to", " ", "a", " ", 
     "dataset", " ", "and", " ", "returns", " ", "the", " ", "number", " ", 
     "of", " ", "labeled", " ", "filaments", " ", "in", " ", "each", " ", 
     "arch"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countLabeledFilamentsData", "[", 
      RowBox[{"data_", ",", "pattern_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"countLabeledFilaments", "[", 
        RowBox[{"#", ",", "pattern"}], "]"}], "&"}], "/@", "data"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "A", " ", "combination", " ", "of", " ", "countSwitches", " ", "and", " ",
      "countLabeledFilaments", " ", "for", " ", "an", " ", "arch"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countSwitchesLabFil", "[", 
      RowBox[{"arc_", ",", "pattern_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"countSwitches", "[", 
         RowBox[{"arc", ",", "pattern"}], "]"}], ",", 
        RowBox[{"countLabeledFilaments", "[", 
         RowBox[{"arc", ",", "pattern"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Applies", " ", "countSwitchesLabFil", " ", "to", " ", "a", " ", 
     "dataset"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countSwitchesLabFilData", "[", 
      RowBox[{"data_", ",", "pattern_"}], "]"}], " ", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"countSwitchesLabFil", "[", 
        RowBox[{"#", ",", "pattern"}], "]"}], "&"}], "/@", "data"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Returns", " ", "the", " ", "list", " ", "of", " ", "possible", " ", 
      "arch", " ", "configurations", " ", "for", " ", "each", " ", "pair", 
      " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "with", " ", "s", " ", "switches",
       " ", "and", " ", "f", " ", "labelled", " ", "filaments"}], ",", " ", 
     RowBox[{"in", " ", "an", " ", "arch", " ", "with", " ", "nFil_", " ", 
      RowBox[{"filaments", " ", "[", 
       RowBox[{
        RowBox[{"here", " ", "usually", " ", "nFil"}], "=", "8"}], "]"}]}]}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"getSwitchesLabFilOptions", "[", "nFil_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "possib", ",", " ", "possibSwitchesLabFil", ",", " ", "allPairPossib",
          ",", " ", "numberPairPossib", ",", " ", "positionsPairPossib", ",", 
         " ", "configPossib", ",", " ", "configPossibString"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Get", " ", "all", " ", "possible", " ", "arch", " ", 
         "configurations", " ", "for", " ", "an", " ", "nFil_", " ", "long", 
         " ", "arch", " ", "filled", " ", "with", " ", "binary", " ", 
         RowBox[{"entries", "."}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"possib", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", " ", "##"}], "]"}], " ", "&"}], " ", "@@", 
          " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"{", "nFil", "}"}]}], "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"possib", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"possib", "/", "1."}], ",", "7"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"For", " ", "each", " ", "configuration"}], ",", " ", 
          RowBox[{
          "compute", " ", "the", " ", "number", " ", "of", " ", "switches", 
           " ", "and", " ", "labelled", " ", "filaments"}], ",", " ", 
          RowBox[{
          "obtaining", " ", "the", " ", "respective", " ", "pairs", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", ",", "f"}], ")"}], "."}]}]}], " ", "*)"}], "\n", 
        "\t", 
        RowBox[{"possibSwitchesLabFil", " ", "=", " ", 
         RowBox[{"countSwitchesLabFilData", "[", 
          RowBox[{"possib", ",", "1."}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Only", " ", "keep", " ", "the", " ", "possible", " ", "pairs", " ", 
           RowBox[{"(", 
            RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "from", " ", "the", " ", "existing", " ", "arch", " ", 
            "configuration", " ", 
            RowBox[{"options", ".", " ", "E", ".", "g", ".", " ", "the"}], 
            " ", "pair", " ", 
            RowBox[{"(", 
             RowBox[{"s", ",", "f"}], ")"}]}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}], " ", "is", " ", "not", " ", 
            RowBox[{"possible", "."}]}]}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{"allPairPossib", " ", "=", " ", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "possibSwitchesLabFil", "]"}], 
           ",", "First"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "allPairPossib", "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"getFilConfigOptions", "[", "nFil_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "possib", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"possib", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", " ", "##"}], "]"}], " ", "&"}], " ", "@@", 
          " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"{", "nFil", "}"}]}], "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"possib", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"possib", "*", "1."}], ",", "7"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"Return", "[", "possib", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "options_", " ", "is", " ", "a", " ", "list", " ", "of", " ", "possible",
       " ", "combinations", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"number", " ", "of", " ", "switches"}], ",", " ", 
        RowBox[{"number", " ", "of", " ", "labeled", " ", "filaments"}]}], 
       "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "pairs"}], " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{
     "given", " ", "by", " ", "the", " ", "function", " ", 
      "getSwitchesLabFilOptions"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "dataCount_", " ", "is", " ", "the", " ", "result", " ", "of", " ", 
      "countSwitchesLabFilData", " ", "applied", " ", "to", " ", "the", " ", 
      "dataset"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "a"}], " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "for", " ", "each", " ", "arch", 
      " ", "in", " ", "the", " ", "data"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Returns", " ", "the", " ", "number", " ", "of", " ", "instances", " ", 
     "in", " ", "which", " ", "a", " ", "combination", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "given", " ", "in", " ", 
     "options_", " ", "is", " ", "found", " ", "in", " ", "the", " ", 
     "dataCount_"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countInstances", "[", 
      RowBox[{"dataCount_", ",", " ", "options_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "count", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"count", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"dataCount", ",", "#"}], "]"}], "&"}], "/@", 
          "options"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "count", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Counts", " ", "the", " ", "instances", " ", "as", " ", "before"}], ",", 
     " ", 
     RowBox[{
     "but", " ", "in", " ", "a", " ", "dataset", " ", "containing", " ", 
      "more", " ", "sublists"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "countInstances"}], " ", "can", " ", 
      "be", " ", "applied", " ", "to", " ", 
      RowBox[{"dataPatterned", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
     RowBox[{
     "while", " ", "countInstancesDataset", " ", "is", " ", "applied", " ", 
      "to", " ", "dataPatterned"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"countInstancesDataset", "[", 
      RowBox[{"dataSet_", ",", "options_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"countInstances", "[", 
        RowBox[{
         RowBox[{"dataSet", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "options"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "dataSet", "]"}], "]"}]}]}], ";"}], "\n", "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "compute", " ", "frequency", " ", "of", " ", "observing", " ", "a", " ", 
     "certain", " ", "sequence", " ", "of", " ", "8", " ", "filaments", " ", 
     "arc_", " ", "in", " ", "the", " ", "data_"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeFreqArcDistr", "[", 
      RowBox[{"data_", ",", "arc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"count", ",", "freq"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"count", " ", "=", " ", 
         RowBox[{"Count", "[", 
          RowBox[{"data", ",", "arc"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"freq", " ", "=", " ", 
         RowBox[{"count", "/", 
          RowBox[{"Length", "[", "data", "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "freq", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "computing", " ", "the", " ", "frequency", " ", "of", 
      " ", "observing", " ", "each", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{"from", " ", "options_"}], ",", " ", 
     RowBox[{"in", " ", "the", " ", "data_"}], ",", " ", 
     RowBox[{"for", " ", "studying", " ", "pattern_."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeFreqSFPattern", "[", 
      RowBox[{"data_", ",", "pattern_", ",", "options_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dataSwitchLabFil", ",", "counter", ",", "freqData"}], "}"}], 
       ",", "\n", "\t", 
       RowBox[{
        RowBox[{"dataSwitchLabFil", " ", "=", " ", 
         RowBox[{"countSwitchesLabFilData", "[", 
          RowBox[{"data", ",", 
           RowBox[{"pattern", "*", "1."}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"counter", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"dataSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
          "options"}]}], ";", "\n", "\t", 
        RowBox[{"freqData", " ", "=", " ", 
         RowBox[{"counter", "/", 
          RowBox[{"Length", "[", "dataSwitchLabFil", "]"}]}]}], ";", "\n", 
        "\t", 
        RowBox[{"Return", "[", "freqData", "]"}], ";"}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "computing", " ", "the", " ", "frequency", " ", "of", 
      " ", "observing", " ", "each", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{"from", " ", "options_"}], ",", " ", 
     RowBox[{"in", " ", "the", " ", "data_"}], ",", " ", 
     RowBox[{"for", " ", "studying", " ", "all", " ", 
      RowBox[{"patterns", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeFreqSF", "[", 
      RowBox[{"data_", ",", "options_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"computeFreqSFPattern", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#", ",", "options"}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"FUNCTIONS", " ", "For", " ", "HOMOGENEOUS", " ", 
     RowBox[{"MODELS", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Simulate", " ", "scenario", " ", "in", " ", "which", " ", "each", " ", 
      "filament", " ", "comes", " ", "from", " ", "a", " ", "progenitor"}], 
     ",", " ", 
     RowBox[{
     "having", " ", "the", " ", "labeling", " ", "efficiency", " ", "labEff_",
       " ", "as", " ", 
      RowBox[{"parameter", ".", " ", "\n", "A"}], " ", "progenitor", " ", 
      "generates", " ", "only", " ", "one", " ", 
      RowBox[{"filament", ".", " ", "Repeat"}], " ", "trials_", " ", "many", 
      " ", 
      RowBox[{"times", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateProgenitor", "[", 
      RowBox[{"labEff_", ",", " ", "trials_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "listCells", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"listCells", " ", "=", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomVariate", "[", 
             RowBox[{
              RowBox[{"BernoulliDistribution", "[", "labEff", "]"}], ",", 
              "8"}], "]"}], ",", 
            RowBox[{"{", "trials", "}"}]}], "]"}], "*", "1."}]}], ";", "\n", 
        "\t", 
        RowBox[{"Return", "[", "listCells", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Simulate", " ", "scenario", " ", "in", " ", "which", " ", "all", " ", 
      "filaments", " ", "come", " ", "from", " ", "a", " ", "single", " ", 
      "stem", " ", "cell"}], ",", " ", "\n", 
     RowBox[{
     "and", " ", "having", " ", "the", " ", "overall", " ", "labeling", " ", 
      "efficiency", " ", "labEff_", " ", "within", " ", "the", " ", "trials_",
       " ", "many", " ", 
      RowBox[{"arcs", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateStem", "[", 
      RowBox[{"labEff_", ",", " ", "trials_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"listCells", ",", " ", "listArcs"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"listCells", " ", "=", " ", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"BernoulliDistribution", "[", "labEff", "]"}], ",", 
           "trials"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"listArcs", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"#", ",", "8"}], "]"}], "&"}], "/@", "listCells"}], 
           ")"}], "*", "1."}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "listArcs", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "OBJECTIVE", " ", "FUNCTIONS", " ", "FOR", " ", "HOMOGENEOUS", " ", 
     RowBox[{"MODELS", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Build", " ", "sum"}], "-", "of", "-", 
     RowBox[{
     "squares", " ", "oblective", " ", "function", " ", "to", " ", "compare", 
      " ", "progenitor", " ", "model", " ", "to", " ", "data"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"objFunProgenitors", "[", 
      RowBox[{
      "branchiaDat_", ",", "labEff_", ",", " ", "trials_", ",", "options_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"objFunProgenitors", "[", 
       RowBox[{
       "branchiaDat", ",", "labEff", ",", " ", "trials", ",", "options"}], 
       "]"}], " ", "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "fun", ",", " ", "simRes", ",", " ", "simSwitchLabFil", ",", " ", 
          "counterSim", ",", " ", "probsSim", ",", " ", "probsDat", ",", 
          "counterDat", ",", "datSwitchLabFil"}], "}"}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"simRes", " ", "=", " ", 
          RowBox[{"simulateProgenitor", "[", 
           RowBox[{"labEff", ",", " ", "trials"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"simSwitchLabFil", " ", "=", " ", 
          RowBox[{"countSwitchesLabFilData", "[", 
           RowBox[{"simRes", ",", "1."}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "simulations", " ", "always", " ", "put", " ", "0", " ", "or", " ",
             "1", " ", "so", " ", "for", " ", "counting", " ", "switches", 
            " ", "in", " ", "simulations", " ", "look", " ", "for", " ", "0", 
            " ", "or", " ", "1"}], ",", " ", 
           RowBox[{"regardless", " ", "of", " ", "pattern"}]}], " ", "*)"}], 
         "\n", "\t", 
         RowBox[{"datSwitchLabFil", " ", "=", " ", 
          RowBox[{"countSwitchesLabFilData", "[", 
           RowBox[{"branchiaDat", ",", "1."}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"counterSim", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"simSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
           "options"}]}], ";", "\n", "\t", 
         RowBox[{"probsSim", " ", "=", " ", 
          RowBox[{"counterSim", "/", "trials"}]}], ";", "\n", "\t", 
         RowBox[{"counterDat", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"datSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
           "options"}]}], ";", "\n", "\t", 
         RowBox[{"probsDat", " ", "=", " ", 
          RowBox[{"counterDat", "/", 
           RowBox[{"Length", "[", "branchiaDat", "]"}]}]}], ";", "\n", "\t", 
         RowBox[{"fun", " ", "=", " ", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"probsSim", "-", "probsDat"}], ")"}], "^", "2"}], "]"}],
            "*", 
           RowBox[{"10", "^", "4"}]}]}], ";", "\n", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"fun", ",", ".0001"}], "]"}], "]"}], ";"}]}], "\n", 
       "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Build", " ", "sum"}], "-", "of", "-", 
     RowBox[{
     "squares", " ", "oblective", " ", "function", " ", "to", " ", "compare", 
      " ", "stem", " ", "cell", " ", "model", " ", "to", " ", "data"}]}], " ",
     "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"objFunStem", "[", 
      RowBox[{
      "branchiaDat_", ",", "labEff_", ",", " ", "trials_", ",", "options_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"objFunStem", "[", 
       RowBox[{
       "branchiaDat", ",", "labEff", ",", " ", "trials", ",", "options"}], 
       "]"}], " ", "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "fun", ",", " ", "simRes", ",", " ", "simSwitchLabFil", ",", " ", 
          "counterSim", ",", " ", "probsSim", ",", " ", "probsDat", ",", 
          "counterDat", ",", "datSwitchLabFil"}], "}"}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"simRes", " ", "=", " ", 
          RowBox[{"simulateStem", "[", 
           RowBox[{"labEff", ",", " ", "trials"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"simSwitchLabFil", " ", "=", " ", 
          RowBox[{"countSwitchesLabFilData", "[", 
           RowBox[{"simRes", ",", "1."}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "simulations", " ", "always", " ", "put", " ", "0", " ", "or", " ",
             "1", " ", "so", " ", "for", " ", "counting", " ", "switches", 
            " ", "in", " ", "simulations", " ", "look", " ", "for", " ", "0", 
            " ", "or", " ", "1"}], ",", " ", 
           RowBox[{"regardless", " ", "of", " ", "pattern"}]}], " ", "*)"}], 
         "\n", "\t", 
         RowBox[{"datSwitchLabFil", " ", "=", " ", 
          RowBox[{"countSwitchesLabFilData", "[", 
           RowBox[{"branchiaDat", ",", "1."}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"counterSim", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"simSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
           "options"}]}], ";", "\n", "\t", 
         RowBox[{"probsSim", " ", "=", " ", 
          RowBox[{"counterSim", "/", "trials"}]}], ";", "\n", "\t", 
         RowBox[{"counterDat", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"datSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
           "options"}]}], ";", "\n", "\t", 
         RowBox[{"probsDat", " ", "=", " ", 
          RowBox[{"counterDat", "/", 
           RowBox[{"Length", "[", "branchiaDat", "]"}]}]}], ";", "\n", "\t", 
         RowBox[{"fun", " ", "=", " ", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"probsSim", "-", "probsDat"}], ")"}], "^", "2"}], "]"}],
            "*", 
           RowBox[{"10", "^", "4"}]}]}], ";", "\n", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"fun", ",", ".0001"}], "]"}], "]"}], ";"}]}], "\n", 
       "]"}]}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FUNCTIONS", " ", "FOR", " ", "ALGORITHMIC", " ", "APPROACH", " ", "FOR", 
     " ", "HETEROGENEOUS", " ", 
     RowBox[{"MODEL", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Recursive", " ", "function", " ", "to", " ", "simulate", " ", "a", " ", 
      "branchial", " ", "arch"}], ",", " ", 
     RowBox[{
     "when", " ", "there", " ", "are", " ", "nLC_", " ", "labelled", " ", 
      "and", " ", "nUC_", " ", "unlabelled", " ", "cells", " ", "in", " ", 
      "the", " ", 
      RowBox[{"niche", ".", "\n", "Arc_"}], " ", "always", " ", "has", " ", 
      "to", " ", "be", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "}"}], " ", "[", 
        RowBox[{
        "we", " ", "start", " ", "with", " ", "an", " ", "empty", " ", "arc", 
         " ", "in", " ", "which", " ", "we", " ", "add", " ", "filaments"}], 
        "]"}], ".", "\n", "N_"}], " ", "is", " ", "the", " ", "number", " ", 
      "of", " ", "filaments", " ", "that", " ", "we", " ", "will", " ", "add",
       " ", "in", " ", "the", " ", 
      RowBox[{
       RowBox[{"arc", " ", "[", 
        RowBox[{
         RowBox[{"in", " ", "the", " ", "current", " ", "project"}], ",", " ", 
         RowBox[{
         "N_", " ", "has", " ", "been", " ", "set", " ", "to", " ", "8"}]}], 
        "]"}], ".", "\n", "prob_"}], " ", "is", " ", "the", " ", 
      "probability", " ", "that", " ", "the", " ", "cell", " ", "which", " ", 
      "just", " ", "divided", " ", "will", " ", "divide", " ", "again", " ", 
      "in", " ", "the", " ", "next", " ", "time", " ", 
      RowBox[{"step", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateBranchiaCells", "[", 
      RowBox[{"nLC_", ",", "nUC_", ",", "arc_", ",", "prob_", ",", "N_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", " ", "arcNew", ",", " ", "L", ",", " ", "update", ",", " ", 
         "lastFilament", ",", " ", "n", ",", " ", "lab", ",", " ", "weights", 
         ",", " ", "labNew"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"L", " ", "=", " ", 
         RowBox[{"Length", "[", "arc", "]"}]}], ";", "\n", "\t", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"nLC", "+", "nUC"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"total", " ", "number", " ", "of", " ", "cells"}], " ", 
         "*)"}], "\n", "\t", 
        RowBox[{"lab", "=", 
         RowBox[{"{", 
          RowBox[{"nUC", ",", "nLC"}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"L", "\[Equal]", "0"}], ",", 
          "                                       ", 
          RowBox[{"(*", " ", 
           RowBox[{"if", " ", "the", " ", "arch", " ", "is", " ", "empty"}], 
           " ", "*)"}], "\n", "\t\t", 
          RowBox[{
           RowBox[{"update", " ", "=", " ", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"nLC", ",", "nUC"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ";", "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "add", " ", "a", " ", "filament", " ", "with", " ", "label", " ",
               "chosen", " ", "by", " ", "a", " ", "weighted", " ", "random", 
              " ", "choice"}], ","}], "  ", "*)"}], "\n", "\t\t", 
           RowBox[{"arcNew", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"arc", ",", "update"}], "]"}]}], ";", "             ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "with", " ", "weights", " ", "given", " ", "by", " ", "numbers", 
             " ", "nLC_", " ", "and", " ", "nUC_", " ", "of", " ", "cells", 
             " ", "of", " ", "each", " ", "label"}], " ", "*)"}], "\n", 
           "\t\t", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"arc", ",", 
              RowBox[{"simulateBranchiaCells", "[", 
               RowBox[{
               "nLC", ",", "nUC", ",", "arcNew", ",", "prob", ",", "N"}], 
               "]"}]}], "}"}], "]"}]}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"run", " ", "the", " ", "function", " ", "again"}], ",", 
            " ", 
            RowBox[{
            "with", " ", "arc_", " ", "being", " ", "filled", " ", "with", 
             " ", "the", " ", "first", " ", "entry"}]}], " ", "*)"}], "\n", 
          "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"L", "\[GreaterEqual]", "0"}], " ", "*)"}], "\n", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"L", "<", "N"}], ",", 
             "                                   ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "if", " ", "the", " ", "arch", " ", "is", " ", "not", " ", 
                "empty"}], ",", " ", 
               RowBox[{
               "but", " ", "has", " ", "less", " ", "than", " ", "N_", " ", 
                "filaments"}]}], " ", "*)"}], "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"lastFilament", " ", "=", " ", 
               RowBox[{"Last", "[", "arc", "]"}]}], ";", "             ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "check", " ", "the", " ", "label", " ", "of", " ", "last", " ",
                 "filament", " ", "added"}], " ", "*)"}], "\n", "\t\t\t", 
              RowBox[{"labNew", " ", "=", " ", "lab"}], ";", 
              "                         ", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"labNew", "[", 
                RowBox[{"[", 
                 RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}], "=", 
               RowBox[{"n", "+", "1"}]}], ";", "         ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "change", " ", "the", " ", "value", " ", "of", " ", "the", " ",
                 "entry", " ", "corresponding", " ", "to", " ", "the", " ", 
                "label", " ", "of", " ", "the", " ", "previously", " ", 
                "diving", " ", "cell"}], " ", "*)"}], "\n", "           ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Define", " ", 
                   RowBox[{"weights", ":", " ", "w1"}]}], "=", 
                  RowBox[{"p", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nLC", "-", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}]}]}]}], ";", " ", 
                 RowBox[{"w2", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "p"}], ")"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nUC", "-", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}], " ", "if", " ", "a", 
                   " ", "labelled", " ", "cell", " ", "divided", " ", 
                   RowBox[{"last", ".", " ", "Or"}], " ", "vice", " ", 
                   "versa", " ", 
                   RowBox[{"(", 
                    RowBox[{"nLC", " ", "\[UndirectedEdge]", " ", "nUC"}], 
                    ")"}], " ", "if", " ", "an", " ", "unlabelled", " ", 
                   "cel", " ", "divided", " ", 
                   RowBox[{"last", ".", "\n", "              ", 
                    RowBox[{"lab", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}]}], " ", 
                   "selects", " ", "the", " ", "number", " ", "of", " ", 
                   "cells", " ", "of", " ", "the", " ", "label", " ", "that", 
                   " ", "was", " ", "added", " ", "in", " ", "the", " ", 
                   "previous", " ", "step"}]}], ";", " ", "\n", 
                 "              ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"labNew", ",", 
                    RowBox[{"{", 
                    RowBox[{"labNew", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}], "}"}]}],
                     "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "selects", " ", 
                   "the", " ", "number", " ", "of", " ", "cells", " ", "of", 
                   " ", "the", " ", "other", " ", 
                   RowBox[{"label", ".", " ", "\n", "              ", 
                    RowBox[{"Example", ":", " ", 
                    RowBox[{"suppose", " ", "nLC"}]}]}]}], "=", "2"}]}], ",", 
                " ", 
                RowBox[{"nUC", "=", "3"}], ",", " ", 
                RowBox[{"n", "=", "5"}], ",", " ", 
                RowBox[{
                 RowBox[{"and", " ", "lastFilament"}], "=", 
                 RowBox[{
                  RowBox[{"1.", " ", "Then", " ", "lab"}], "=", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "2"}], "}"}]}]}], ",", " ", 
                RowBox[{
                 RowBox[{"labNew", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "6"}], "}"}], ".", " ", "\n", 
                    "                       ", 
                    RowBox[{"lab", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}]}], " ", 
                   "=", " ", 
                   RowBox[{"2", " ", "=", " ", "nLC"}]}]}], ";", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{"labNew", ",", 
                    RowBox[{"{", 
                    RowBox[{"labNew", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}], "}"}]}],
                     "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", "6", "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
                   RowBox[{"3", " ", "=", " ", 
                    RowBox[{"nUC", "."}]}]}]}]}]}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{"weights", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"prob", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "prob"}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"lab", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}], "-", 
                    "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}]}]}], ")"}], ",", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "prob"}], ")"}], "*", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"labNew", ",", 
                    RowBox[{"{", 
                    RowBox[{"labNew", "[", 
                    RowBox[{"[", 
                    RowBox[{"lastFilament", "+", "1"}], "]"}], "]"}], "}"}]}],
                     "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}], "}"}]}], ";",
               "                                           ", "\n", "\t\t\t", 
              RowBox[{"update", " ", "=", " ", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{"weights", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"lastFilament", ",", 
                   RowBox[{"1", "-", "lastFilament"}]}], "}"}]}], "]"}]}], 
              ";", "   ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "assign", " ", "the", " ", "weights", " ", "to", " ", "their",
                  " ", "corresponding", " ", "labels", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", " ", "or", " ", "0"}], ")"}]}], ",", " ", 
                RowBox[{
                "and", " ", "select", " ", "a", " ", "new", " ", "dividing", 
                 " ", "cell", " ", "by", " ", "weighted", " ", "random", " ", 
                 "choice"}]}], " ", "*)"}], "\n", "\t\t\t", 
              RowBox[{"arcNew", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"arc", ",", "update"}], "]"}]}], ";", "     ", 
              RowBox[{"(*", " ", 
               RowBox[{"add", " ", "the", " ", "new", " ", "filament", " ", 
                RowBox[{"(", "label", ")"}], " ", "to", " ", "the", " ", 
                RowBox[{"arch", "."}]}], " ", "*)"}], "\n", "\t\t\t", 
              RowBox[{"Return", "[", 
               RowBox[{"{", 
                RowBox[{"arc", ",", 
                 RowBox[{"simulateBranchiaCells", "[", 
                  RowBox[{
                  "nLC", ",", "nUC", ",", "arcNew", ",", "prob", ",", "N"}], 
                  "]"}]}], "}"}], "]"}]}], ",", "   ", 
             RowBox[{"(*", " ", 
              RowBox[{"rerun", " ", "the", " ", "function"}], " ", "*)"}], 
             "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{"L", "\[GreaterEqual]", "N"}], " ", "*)"}], "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"Return", "[", "arc", "]"}], ";"}]}], "  ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "when", " ", "the", " ", "whole", " ", "N_", " ", "entries", 
               " ", "have", " ", "been", " ", "filled"}], ",", " ", 
              RowBox[{"return", " ", "the", " ", "final", " ", 
               RowBox[{"result", "."}]}]}], " ", "*)"}], "\n", "          ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "The", " ", "structure", " ", "of", " ", "the", " ", "final", 
               " ", "result", " ", "is", " ", "nested", " ", "lists"}], ",", 
              " ", 
              RowBox[{
              "opening", " ", "a", " ", "new", " ", "one", " ", "at", " ", 
               "each", " ", 
               RowBox[{
               "step", ".", " ", "\n", "             ", "E", ".", "g", ".", 
                " ", "One"}], " ", "run", " ", "of", " ", 
               RowBox[{"simulateBranchiaCells", "[", 
                RowBox[{"2", ",", "3", ",", 
                 RowBox[{"{", "}"}], ",", "0.5", ",", "8"}], "]"}], " ", 
               "returns", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "1", ",", "1", ",", "1"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
                    "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}]}], " ", 
             "*)"}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], ";"}]}],
       "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "partitions", " ", "a", " ", "list", " ", "in", " ", "unequal", " ", 
     "sublists"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"partitionBy", "[", 
      RowBox[{"L_List", ",", " ", "func_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{"partitionBy", "[", 
        RowBox[{"L", ",", " ", "func", ",", " ", "1", ",", " ", "0"}], "]"}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"partitionBy", "[", 
      RowBox[{"L_List", ",", " ", "func_", ",", " ", "i_", ",", " ", "pos_"}],
       "]"}], " ", ":=", "\n", "  ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"pos", " ", "+", " ", 
          RowBox[{"func", "[", "i", "]"}]}]}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"partitionBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sow", " ", "@", " ", 
            RowBox[{"L", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"pos", " ", "+", " ", "1"}], " ", ";;", " ", "x"}], 
              "]"}], "]"}]}], ";", " ", "L"}], ",", " ", "func", ",", " ", 
          RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "x"}], "]"}], " ", "/;",
         " ", 
        RowBox[{"x", " ", "<=", " ", 
         RowBox[{"Length", "@", "L"}]}]}]}], "\n", "  ", "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Returns", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
      "intermediate", " ", "arc", " ", "compositions"}], ",", " ", 
     RowBox[{
     "from", " ", "the", " ", "simulation", " ", "results", " ", "of", " ", 
      "the", " ", "previous", " ", 
      RowBox[{"function", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"E", ".", "g", ".", " ", "rest"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", " ", "...", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "0"}], "}"}]}], "}"}]}], "  ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"toArcSeries", "[", "simRes_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"start", ",", "rest"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"start", "=", 
         RowBox[{"simRes", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"rest", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"simRes", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"rest", " ", "=", " ", 
         RowBox[{"partitionBy", "[", 
          RowBox[{"rest", ",", " ", 
           RowBox[{"#", " ", "&"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "rest", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Returns", " ", "the", " ", "branchial", " ", "arch", " ", "composition",
       " ", "at", " ", "the", " ", "last", " ", "time", " ", "point"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "array", " ", "with", 
      " ", "8", " ", 
      RowBox[{"entries", ".", " ", "\n", "E", ".", "g", ".", " ", "from"}], 
      " ", "intermediate", " ", "structure", " ", "returned", " ", "by", " ", 
      RowBox[{"toArcSeries", "[", "]"}]}], ",", " ", 
     RowBox[{"simResult", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "0"}], "}"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"getFinalArc", "[", "simResult_", "]"}], " ", ":=", " ", 
     RowBox[{"Last", "[", 
      RowBox[{"toArcSeries", "[", "simResult", "]"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Run", " ", "the", " ", "function", " ", "simulateBranchiaCells", " ", 
      "described", " ", "before"}], ",", " ", 
     RowBox[{"trials_", " ", "number", " ", "of", " ", 
      RowBox[{"times", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateBranchiaCellsTrials", "[", 
      RowBox[{
      "nLC_", ",", "nUC_", ",", "arc_", ",", "prob_", ",", "N_", ",", " ", 
       "trials_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", " ", "arcNew", ",", " ", "L", ",", " ", "update", ",", " ", 
         "lastFilament", ",", " ", "n", ",", " ", "lab", ",", " ", "weights", 
         ",", " ", "labNew", ",", "i", ",", "sim", ",", " ", "simRes"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"L", " ", "=", " ", 
         RowBox[{"Length", "[", "arc", "]"}]}], ";", "\n", "\t", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"nLC", "+", "nUC"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"number", " ", "of", " ", "cells"}], " ", "*)"}], "\n", "\t", 
        RowBox[{"lab", "=", 
         RowBox[{"{", 
          RowBox[{"nUC", ",", "nLC"}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"sim", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"simulateBranchiaCells", "[", 
            RowBox[{"nLC", ",", "nUC", ",", "arc", ",", "prob", ",", "N"}], 
            "]"}], ",", "trials"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"simRes", " ", "=", " ", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getFinalArc", "[", "#", "]"}], "&"}], ",", "sim"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "simRes", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Simulate", " ", "mini"}], "-", 
      RowBox[{"arches", " ", "trials_", " ", "times"}]}], ",", " ", 
     RowBox[{
     "with", " ", "a", " ", "nCells_", " ", "total", " ", "number", " ", "of",
       " ", "cells"}], ",", " ", 
     RowBox[{
     "and", " ", "random", " ", "values", " ", "for", " ", "\n", "  ", 
      "number", " ", "of", " ", "labelled", " ", "nLC", " ", "and", " ", 
      "unlabelled", " ", "nUC", " ", "cells", " ", "given", " ", "by", " ", 
      RowBox[{"nLC", "~", "Binomial"}], 
      RowBox[{"(", 
       RowBox[{"nCells_", ",", "probLab_"}], ")"}]}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "nUC"}], "=", 
      RowBox[{
       RowBox[{"nCells", "-", 
        RowBox[{
         RowBox[{"nLC", ".", "\n", "  ", "probDiv_"}], " ", "is", " ", "the", 
         " ", "probability", " ", "that", " ", "the", " ", "cell", " ", 
         "which", " ", "just", " ", "divided", " ", "will", " ", "divide", 
         " ", "again", " ", 
         RowBox[{"next", ".", " ", "\n", "  ", "probLab_"}], " ", "is", " ", 
         "the", " ", "labelling", " ", "efficiency", " ", "obtained", " ", 
         "with", " ", "function", " ", 
         RowBox[{"getLabelEfficiencyPattern", ".", " ", "\n", "  ", "nFil_"}],
          " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
         "filaments", " ", "to", " ", "be", " ", 
         RowBox[{
          RowBox[{"added", " ", "[", 
           RowBox[{"usually", ",", " ", 
            RowBox[{"nFil", "=", "8"}]}], "]"}], ".", " ", "arc"}]}]}], "=", 
       RowBox[{
        RowBox[{"{", "}"}], " ", "as", " ", 
        RowBox[{"before", "."}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateBranchiaPattern", "[", 
      RowBox[{
      "nCells_", ",", " ", "probDiv_", ",", " ", "probLab_", ",", " ", 
       "nFil_", ",", " ", "arc_", ",", " ", "trials_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nLCList", ",", " ", "sims", ",", " ", "simRes"}], "}"}], ",",
        "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Randomly", " ", "choose", " ", "the", " ", "number", " ", "of", " ",
           "labeled", " ", "cells", " ", "in", " ", "the", " ", "niche"}], 
         ",", " ", 
         RowBox[{"according", " ", "to", " ", "probLab"}], ",", " ", 
         RowBox[{"for", " ", "each", " ", 
          RowBox[{"trial", "."}]}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"nLCList", " ", "=", " ", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"BinomialDistribution", "[", 
            RowBox[{"nCells", ",", " ", "probLab"}], "]"}], ",", " ", 
           "trials"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"The", " ", "simulation", " ", "step"}], ",", " ", 
          RowBox[{"with", " ", "nLC", " ", "labeled", " ", 
           RowBox[{"cells", " ", "[", 
            RowBox[{"taken", " ", "from", " ", "nLCList"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"and", " ", "nCells"}], "-", 
           RowBox[{"nLC", " ", "unlabeled", " ", 
            RowBox[{"cells", "."}]}]}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{"sims", " ", "=", " ", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"simulateBranchiaCells", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"nCells", "-", "#"}], ",", " ", "arc", ",", " ", 
              "probDiv", ",", " ", "nFil"}], "]"}], "&"}], ",", "nLCList"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Rearange", " ", "the", " ", "results", " ", "in", " ", "the", " ", 
           "final", " ", "form"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "a"}], " ", "list", " ", "of", 
            " ", "nFil"}], "-", 
           RowBox[{"filaments", " ", "long", " ", "branchial", " ", 
            RowBox[{"arcs", "."}]}]}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{"simRes", " ", "=", " ", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getFinalArc", "[", "#", "]"}], "&"}], ",", "sims"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"simRes", " ", "=", " ", 
         RowBox[{"simRes", "*", "1."}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "simRes", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FUNCTIONS", " ", "FOR", " ", "ANALYTIC", " ", "APPROACH", " ", "FOR", 
     " ", "HETEROGENEOUS", " ", 
     RowBox[{"MODEL", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Probability", " ", "transition", " ", "matrix", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"at", " ", "first", " ", "step"}], ")"}], ".", " ", "If"}], 
      " ", "n"}], "=", 
     RowBox[{
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", "."}], ",", " ", 
         RowBox[{"only", " ", "one", " ", "stem", " ", "cell"}]}], ")"}], " ",
        "then", " ", "P"}], "=", 
      RowBox[{"Identity", " ", "matrix"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Pmatrix1", "[", 
      RowBox[{"n_", ",", "L_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", ">", "1"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "p"}], ")"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"L", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "p"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "L"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}]}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t\t\t  ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "p"}], ")"}], "*", 
             RowBox[{"L", "/", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}]}], ",", " ", 
            RowBox[{"p", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "p"}], ")"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "L", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}]}]}]}], "}"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "distribution"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lambdaLU", "[", 
      RowBox[{"n_", ",", "L_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "/", "n"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"L", "/", "n"}]}]}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "computing", " ", "the", " ", "probability", " ", "of", 
      " ", "observing", " ", "a", " ", "certain", " ", "distribution", " ", 
      "of", " ", "filaments", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "arc_"}], " ", "=", " ", 
        "10110010"}], ")"}], "\n", "when", " ", "there", " ", "are", " ", 
      "n_", " ", "stem", " ", "cells"}], ",", " ", 
     RowBox[{
     "out", " ", "of", " ", "which", " ", "L_", " ", "are", " ", "labelled"}],
      ",", " ", 
     RowBox[{
     "and", " ", "a", " ", "probability", " ", "of", " ", "division", " ", 
      "p_"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeProbArcDistr", "[", 
      RowBox[{"n_", ",", "L_", ",", "p_", ",", "arc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "len", ",", "transitions", ",", "update", ",", "arcPartitioned", ",", 
         "pos", ",", "prob", ",", "j"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"arcPartitioned", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"arc", ",", "2", ",", "1"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"transitions", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1.", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}], "}"}]}], ";", "\n",
         "\t", 
        RowBox[{"len", " ", "=", " ", 
         RowBox[{"Length", "[", "arcPartitioned", "]"}]}], ";", "\n", "\t", 
        RowBox[{"j", "=", "1"}], ";", "\n", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "<=", "len"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "find", " ", "the", " ", "entry", " ", "corresponding", " ", 
                "to", " ", "first", " ", "fialment"}], ",", " ", 
               RowBox[{
               "in", " ", "the", " ", "initial", " ", "distribution", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"e", ".", "g", ".", " ", "if"}], " ", "first", 
                    " ", "filament"}], " ", "=", " ", "0"}], ",", " ", 
                  RowBox[{
                   RowBox[{"then", " ", "prob"}], "=", 
                   RowBox[{"U", "/", "n"}]}]}], " "}]}]}], "*)"}], "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"prob", "=", 
               RowBox[{
                RowBox[{"lambdaLU", "[", 
                 RowBox[{"n", ",", "L"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"2", "-", 
                   RowBox[{"arc", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              ";", "\n", "\t\t\t", 
              RowBox[{"pos", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"transitions", ",", 
                   RowBox[{"arcPartitioned", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "1"}], 
                "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"the", " ", "next", " ", "step"}], ",", " ", 
                RowBox[{
                "updates", " ", "the", " ", "probability", " ", "of", " ", 
                 "trajectory", " ", "including", " ", "the", " ", "next", " ",
                  "transition"}]}], " ", "*)"}], "\n", "\t\t\t", 
              RowBox[{"update", " ", "=", " ", 
               RowBox[{"prob", "*", 
                RowBox[{"Extract", "[", 
                 RowBox[{
                  RowBox[{"Pmatrix1", "[", 
                   RowBox[{"n", ",", "L", ",", "p"}], "]"}], ",", "pos"}], 
                 "]"}]}]}]}], ",", "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"for", " ", "j"}], "\[GreaterEqual]", "1"}], " ", 
              "*)"}], "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
              "the", " ", "update", " ", "of", " ", "trajectory", " ", 
               "probability", " ", "continues", " ", "until", " ", "the", " ",
                "end", " ", "of", " ", "the", " ", "arch", " ", "is", " ", 
               "reached"}], " ", "*)"}], "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"transitions", ",", 
                   RowBox[{"arcPartitioned", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "1"}], 
                "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"update", " ", "=", " ", 
               RowBox[{"update", "*", 
                RowBox[{"Extract", "[", 
                 RowBox[{
                  RowBox[{"Pmatrix1", "[", 
                   RowBox[{"n", ",", "L", ",", "p"}], "]"}], ",", "pos"}], 
                 "]"}]}]}]}]}], "\n", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "the", " ", "final", " ", "result", " ", "for", " ", "an", " ", 
               "arch", " ", "arc_"}], "=", 
              RowBox[{
               RowBox[{"10110010", " ", "should", " ", 
                RowBox[{"read", ":", " ", "update"}]}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"L", "/", "n"}], "*", "p12", "*", "p21", "*", "p11", 
                 "*", "p12", "*", "p22", "*", "p21", "*", "p12"}], " ", "=", 
                " ", 
                RowBox[{
                 RowBox[{"L", "/", "n"}], "*", "p11", "*", 
                 RowBox[{"p12", "^", "3"}], "*", 
                 RowBox[{"p21", "^", "2"}], "*", "p22"}]}]}]}], " ", "*)"}], 
            "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
           RowBox[{"j", "++"}], ";"}]}], "\n", "\t\t", "]"}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "update", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "computing", " ", "the", " ", "probability", " ", "of", 
      " ", "observing", " ", "a", " ", "certain", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", "\n", 
     RowBox[{
     "knowing", " ", "we", " ", "have", " ", "n_", " ", "stem", " ", 
      "cells"}], ",", " ", 
     RowBox[{"L_", " ", "of", " ", "which", " ", "are", " ", "labelled"}], 
     ",", " ", 
     RowBox[{
     "and", " ", "probability", " ", "of", " ", "division", " ", "p_"}], ",", 
     " ", "\n", 
     RowBox[{
      RowBox[{
      "inputing", " ", "all", " ", "possible", " ", "arch", " ", 
       "configurations", " ", "listFil_"}], " ", "=", " ", 
      RowBox[{"getFilConfigOptions", 
       RowBox[{"(", "8", ")"}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"probSFL", "[", 
      RowBox[{
      "s_", ",", "f_", ",", "n_", ",", "L_", ",", "p_", ",", "listFil_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"listSF", ",", "pos", ",", "probList", ",", "res"}], "}"}], 
       ",", "\n", "\t", 
       RowBox[{
        RowBox[{"listSF", " ", "=", " ", 
         RowBox[{"countSwitchesLabFilData", "[", 
          RowBox[{"listFil", ",", "1."}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "here", " ", "for", " ", "8", " ", "filament", " ", "mini"}], "-", 
           "arches"}], ",", " ", 
          RowBox[{
           RowBox[{"listFil_", " ", "=", " ", "listFilDistr"}], ";", " ", 
           RowBox[{
            RowBox[{"here", " ", "use", " ", "integer"}], "-", 
            RowBox[{"type", " ", "pattern"}]}]}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{"pos", " ", "=", " ", 
         RowBox[{"Position", "[", 
          RowBox[{"listSF", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "f"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"probList", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"computeProbArcDistr", "[", 
            RowBox[{"n", ",", "L", ",", "p", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Extract", "[", 
           RowBox[{"listFil", ",", "pos"}], "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Total", "[", "probList", "]"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "res", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "computing", " ", "the", " ", "probability", " ", "of", 
      " ", "observing", " ", "a", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{"like", " ", "before", " ", 
      RowBox[{"(", 
       RowBox[{"with", " ", "probSFL"}], ")"}]}], ",", " ", 
     RowBox[{
     "but", "\n", "instead", " ", "of", " ", "inputing", " ", "the", " ", 
      "number", " ", "of", " ", "labelled", " ", "cells", " ", "L_"}], ",", 
     " ", 
     RowBox[{
     "it", " ", "automatically", " ", "computes", " ", "based", " ", "on", 
      " ", 
      RowBox[{"L", "~", "Binomial"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", ",", "probLab"}], ")"}], "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"probSF", "[", 
      RowBox[{
      "s_", ",", "f_", ",", "n_", ",", "p_", ",", "probLab_", ",", 
       "listFil_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "probs", ",", "res", ",", "Lkprob", ",", "L0prob", ",", "Lkprobs"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Compute", " ", "probabilities", " ", "of", " ", "observing", " ", 
          "pair", " ", 
          RowBox[{"(", 
           RowBox[{"s", ",", "f"}], ")"}], " ", "for", " ", "all", " ", 
          "possible", " ", "numbers", " ", "of", " ", "labelled", " ", 
          "filaments", " ", "0"}], "\[LessEqual]", " ", "L", " ", 
         "\[LessEqual]", " ", 
         RowBox[{"n", "."}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"probs", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"probSFL", "[", 
            RowBox[{
            "s", ",", "f", ",", "n", ",", "#", ",", "p", ",", "listFil"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "n"}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "here", " ", "for", " ", "8", " ", "filament", " ", "mini"}], "-", 
           "arches"}], ",", " ", 
          RowBox[{"listFil_", " ", "=", " ", "listFilDistr"}]}], " ", "*)"}], 
        "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Probabilities", " ", "of", " ", "having", " ", "L", " ", "labelled",
           " ", "filaments", " ", "follow", " ", 
          RowBox[{"L", "~", "Binomial"}], 
          RowBox[{"(", 
           RowBox[{"n", ",", "probLab"}], ")"}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{"Lkprobs", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PDF", "[", 
            RowBox[{
             RowBox[{"BinomialDistribution", "[", 
              RowBox[{"n", ",", "probLab"}], "]"}], ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "The", " ", "final", " ", "result", " ", "simply", " ", "equals", 
          " ", "the", " ", "product", " ", "of", " ", "the", " ", 
          "probabilities", " ", "computed", " ", "before"}], " ", "*)"}], 
        "\n", "\t", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Lkprobs", ".", "probs"}]}], ";", "\n", "\t", 
        RowBox[{"Return", "[", "res", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Function", " ", "returning", " ", "the", " ", "probabilities", " ", 
      "of", " ", "observing", " ", "each", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "list", " ", "of", " ", "which", " ", "is", " ", "inputed", 
       " ", "in", " ", "options_"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "8"}], "}"}], ",", "...", ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", "4"}], "}"}]}], "}"}], ".", " ", "\n", 
        "Analytic"}], " ", "equivalent", " ", "to", " ", 
       RowBox[{"computeFreqSF", "."}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computeProbSF", "[", 
      RowBox[{
      "n_", ",", "probDiv_", ",", "probLab_", ",", "listFil_", ",", 
       "options_"}], "]"}], " ", ":=", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"probSF", "[", 
         RowBox[{
         "#1", ",", "#2", ",", "n", ",", "probDiv", ",", "probLab", ",", 
          "listFil"}], "]"}], "&"}], ",", 
       RowBox[{"Transpose", "[", "options", "]"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"PLOTTING", " ", "FUNCTIONS"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Blue", " ", "color", " ", "scheme", " ", "to", " ", "be", " ", "used", 
     " ", "in", " ", "plots"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"colorSchemeBlue", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{"#", "/", "255"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"204", ",", "229", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "25", ",", "51"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"153", ",", "204", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"102", ",", "178", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"51", ",", "153", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "128", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "102", ",", "204"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "76", ",", "153"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "51", ",", "102"}], "}"}]}], "}"}]}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Corresponding", " ", "blue", " ", "bar", " ", "legend", " ", "to", " ", 
     "be", " ", "used", " ", "in", " ", "plots"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"barLegendSchemeBlue", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{"#", "/", "255"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"204", ",", "229", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"153", ",", "204", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"102", ",", "178", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"51", ",", "153", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "128", ",", "255"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "102", ",", "204"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "76", ",", "153"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "51", ",", "102"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "25", ",", "51"}], "}"}]}], "}"}]}]}], ";"}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Takes", " ", "dataCounts_", " ", "and", " ", "simCounts_", " ", "given", 
     " ", "by", " ", 
     RowBox[{"countInstances", " ", "[", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "applied"}], " ", "to", " ", "the", 
       " ", "data", " ", "of", " ", "just", " ", "one", " ", "pattern"}], 
      "]"}], " ", "and", " ", "a", " ", "colorScheme_", " ", "given", " ", 
     "by", " ", "a", " ", "list", " ", "of", " ", "colors", " ", "to", " ", 
     "be", " ", "used"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Plots", " ", "a", " ", "stacked", " ", "BarChart", " ", "in", " ", 
      "which", " ", "the", " ", "bars", " ", "represent", " ", "the", " ", 
      "number", " ", "of", " ", "cases", " ", "with", " ", "certain", " ", 
      "number", " ", "of", " ", "switches"}], ",", " ", 
     RowBox[{
      RowBox[{"given", " ", "by", " ", "the", " ", "x"}], "-", "axis"}], ",", 
     " ", "\n", 
     RowBox[{
     "and", " ", "the", " ", "stacked", " ", "bits", " ", "within", " ", "a", 
      " ", "bar", " ", "represent", " ", "the", " ", "cases", " ", "with", 
      " ", "a", " ", "certain", " ", "number", " ", "of", " ", "filaments"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"given", " ", "by", " ", "the", " ", "color"}], " ", "-", " ", 
      RowBox[{"the", " ", "darker", " ", "the", " ", "color"}]}], ",", " ", 
     RowBox[{
     "the", " ", "higher", " ", "the", " ", "number", " ", "of", " ", 
      "filaments"}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"The", " ", "bars", " ", "alternate", " ", "Data"}], ",", " ", 
     "Sim", ",", " ", "Data", ",", " ", 
     RowBox[{
      RowBox[{"Sim", "..."}], " ", "for", " ", "each", " ", "case", " ", "of",
       " ", "number", " ", "of", " ", "switches"}], ",", " ", 
     RowBox[{"to", " ", "facilitate", " ", "the", " ", "comparison"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
      "dataCounts_", ",", " ", "simCounts_", ",", "colorScheme_", ",", 
       "title_", ",", "barLegendScheme_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "counts", ",", " ", "dataProbs", ",", " ", "simProbs", ",", " ", 
         "counts2", ",", " ", "counts3", ",", " ", "labels", ",", " ", 
         "counts4"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"labels", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Data\>\"", ",", "\"\<Sim\>\"", ",", "\"\<Data\>\"", ",", 
           "\"\<Sim\>\"", ",", "\"\<Data\>\"", ",", "\"\<Sim\>\"", ",", 
           "\"\<Data\>\"", ",", "\"\<Sim\>\"", ",", "\"\<Data\>\"", ",", 
           "\"\<Sim\>\"", ",", "\"\<Data\>\"", ",", "\"\<Sim\>\"", ",", 
           "\"\<Data\>\"", ",", "\"\<Sim\>\"", ",", "\"\<Data\>\"", ",", 
           "\"\<Sim\>\""}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"dataProbs", " ", "=", " ", 
         RowBox[{"dataCounts", "/", 
          RowBox[{"Total", "[", "dataCounts", "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"simProbs", " ", "=", " ", 
         RowBox[{"simCounts", "/", 
          RowBox[{"Total", "[", "simCounts", "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"counts3", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"dataProbs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"dataProbs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", "0", 
               ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
             "\"\<D\>\"", ",", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"simProbs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"simProbs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", "0", 
               ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
             "\"\<S\>\"", ",", "Above"}], "]"}], ",", " ", "\n", "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ";;", "9"}], "]"}], "]"}]}], "}"}], "]"}], 
             ",", "\"\<D\>\"", ",", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ";;", "9"}], "]"}], "]"}]}], "}"}], "]"}], 
             ",", "\"\<S\>\"", ",", "Above"}], "]"}], ",", " ", "\n", 
           "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"10", ";;", "16"}], "]"}], "]"}]}], "}"}], "]"}], 
             ",", "\"\<D\>\"", ",", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"10", ";;", "16"}], "]"}], "]"}]}], "}"}], "]"}], 
             ",", "\"\<S\>\"", ",", "Above"}], "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"17", ";;", "21"}], "]"}], "]"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}], "]"}], ",", "\"\<D\>\"", 
             ",", "Above"}], "]"}], ",", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"17", ";;", "21"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             "\"\<S\>\"", ",", "Above"}], "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"22", ";;", "26"}], "]"}], "]"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}], "]"}], ",", "\"\<D\>\"", 
             ",", "Above"}], "]"}], ",", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"22", ";;", "26"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             "\"\<S\>\"", ",", "Above"}], "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"27", ";;", "29"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             "\"\<D\>\"", ",", " ", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"27", ";;", "29"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], 
              "]"}], ",", "\"\<S\>\"", ",", "Above"}], "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"30", ";;", "32"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             "\"\<D\>\"", ",", " ", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", 
                  RowBox[{"30", ";;", "32"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], 
              "]"}], ",", "\"\<S\>\"", ",", "Above"}], "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
                 ",", " ", 
                RowBox[{"dataProbs", "[", 
                 RowBox[{"[", "33", "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}], 
             ",", "\"\<D\>\"", ",", "Above"}], "]"}], ",", " ", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                RowBox[{"simProbs", "[", 
                 RowBox[{"[", "33", "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                 "}"}]}], "}"}], "]"}], ",", "\"\<S\>\"", ",", "Above"}], 
            "]"}]}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"BarChart", "[", 
         RowBox[{"counts3", ",", " ", 
          RowBox[{"ChartLayout", "\[Rule]", " ", "\"\<Stacked\>\""}], ",", 
          " ", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "16.5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"ChartLabels", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "1", ",", "1", ",", "2", ",", "2", ",", "3",
                ",", "3", ",", "4", ",", "4", ",", "5", ",", "5", ",", "6", 
               ",", "6", ",", "7", ",", "7"}], "}"}], ",", "None"}], "}"}]}], 
          ",", "\n", "\t\t\t", 
          RowBox[{"ChartStyle", "\[Rule]", "colorScheme"}], ",", " ", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Number of switches\>\"", ",", "Bold", ",", "12"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Frequency of pair (s,f)\>\"", ",", "Bold", ",", "12"}], 
              "]"}]}], "}"}]}], ",", " ", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{"title", ",", "Bold", ",", "14"}], "]"}]}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"ChartLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"BarLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"barLegendScheme", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], ",", "8"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.5"}], ",", "0", ",", "1", ",", "2", ",", "3",
                  ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], 
               ",", " ", 
               RowBox[{"LegendMarkerSize", "\[Rule]", "100"}], ",", " ", 
               RowBox[{"LegendMargins", "\[Rule]", "0"}]}], "]"}], ",", 
             "Right"}], "]"}]}]}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Does", " ", "a", " ", "similar", " ", "plot", " ", "to", " ", "the", 
      " ", "one", " ", "before"}], ",", " ", 
     RowBox[{"but", " ", "it", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "plot", " ", "data", " ", "and", " ", 
      "simulations", " ", 
      RowBox[{"together", ".", " ", "Just"}], " ", "one", " ", "or", " ", 
      "the", " ", 
      RowBox[{"other", ".", " ", "\n", "It"}], " ", "also", " ", "includes", 
      " ", "a", " ", "barLegend", " ", "explaining", " ", "the", " ", 
      "colorScheme_"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
      "dataCounts_", ",", "colorScheme_", ",", "barLegendScheme_", ",", 
       "title_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"counts", ",", " ", "dataProbs"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"dataProbs", " ", "=", " ", 
         RowBox[{"dataCounts", "/", 
          RowBox[{"Total", "[", "dataCounts", "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"counts", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"3", ";;", "9"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"10", ";;", "16"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"17", ";;", "21"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"22", ";;", "26"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"27", ";;", "29"}], "]"}], "]"}], ",", 
           RowBox[{"dataProbs", "[", 
            RowBox[{"[", 
             RowBox[{"30", ";;", "32"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"dataProbs", "[", 
             RowBox[{"[", "33", "]"}], "]"}], "}"}]}], "}"}]}], ";", "\n", 
        "\t", 
        RowBox[{"BarChart", "[", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<0 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<0LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<8LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<1 Switch\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<4LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<5LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<6LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "6"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<7LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "7"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            " ", "\n", "           ", 
            RowBox[{"\"\<2 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<4LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<5LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "5"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<6LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "6"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<7LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "7"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<3 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "3"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<4LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<5LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "5"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<4 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "3"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<4LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "4"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"\"\<5LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "5"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<5 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"6", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"6", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"6", ",", "3"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<6 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<1LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"7", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<2LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"7", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<3LC\>\"", "\[Rule]", 
                RowBox[{"counts", "[", 
                 RowBox[{"[", 
                  RowBox[{"7", ",", "3"}], "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\n", "           ", 
            RowBox[{"\"\<7 Switches\>\"", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{"\"\<1LC\>\"", "\[Rule]", 
               RowBox[{"counts", "[", 
                RowBox[{"[", 
                 RowBox[{"8", ",", "1"}], "]"}], "]"}]}], "|>"}]}]}], "|>"}], 
          ",", " ", 
          RowBox[{"ChartLayout", "\[Rule]", " ", "\"\<Stacked\>\""}], ",", 
          " ", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "9.5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", "\n", 
          "\t\t\t", 
          RowBox[{"ChartLabels", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6",
                ",", "7"}], "}"}], ",", "None"}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", "colorScheme"}], ",", "\n", 
          "            ", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", " ", "False"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Probability of pair (s,f)\>\"", ",", "Bold", ",", "12"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Number of switches\>\"", ",", "Bold", ",", "12"}], 
              "]"}]}], "}"}]}], ",", " ", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{"title", ",", "Bold", ",", "14"}], "]"}]}], ",", " ", 
          "\n", "\t\t\t", 
          RowBox[{"ChartLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"BarLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"barLegendScheme", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], ",", "8.5"}], "}"}]}], "}"}], ",", 
               "8", ",", " ", 
               RowBox[{"LegendMarkerSize", "\[Rule]", "100"}], ",", " ", 
               RowBox[{"LegendMargins", "\[Rule]", "0"}]}], "]"}], ",", 
             "Right"}], "]"}]}]}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"OBJECTIVE", " ", "FUNCTIONS"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", " ", "returning", " ", "the", " ", "sum"}], "-", 
      "of", "-", 
      RowBox[{"squres", " ", "objective", " ", "function"}]}], ",", " ", 
     RowBox[{
     "after", " ", "running", " ", "the", " ", "algorithm", " ", "to", " ", 
      "simulate", " ", "in", " ", "silico", " ", "data", "\n", "and", " ", 
      "comparing", " ", "the", " ", "frequencies", " ", "of", " ", 
      "observing", " ", "the", " ", "pairs", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "data", " ", "and", 
      " ", 
      RowBox[{"simulations", ".", " ", "\n", "It"}], " ", "takes", " ", "as", 
      " ", "arguments", " ", "the", " ", "number", " ", "of", " ", "stem", 
      " ", "cells", " ", "nCells_"}], ",", " ", 
     RowBox[{"probability", " ", "of", " ", "division", " ", "probDiv_"}], 
     ",", "\n", 
     RowBox[{"labelling", " ", "efficiency", " ", "probLab_"}], ",", " ", 
     RowBox[{
     "the", " ", "frequencies", " ", "probsDat_", " ", "of", " ", "observing",
       " ", "pairs", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", "data"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"with", " ", 
       RowBox[{"(", 
        RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "options_.", " ", 
       "\n", "nFil_", " ", "is", " ", "the", " ", "number", " ", "of", " ", 
       "filaments", " ", "in", " ", "the", " ", "mini"}], "-", 
      RowBox[{"arch", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"for", " ", "the", " ", "paper", " ", "nFil"}], "=", "8"}], 
        ")"}]}]}], ",", " ", 
     RowBox[{"arc", "=", 
      RowBox[{
       RowBox[{"{", "}"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"the", " ", "empty", " ", "mini"}], "-", "arch"}], ")"}]}]}],
      ",", " ", 
     RowBox[{
     "trials_", " ", "is", " ", "the", " ", "number", " ", "of", " ", "times",
       "\n", "to", " ", "run", " ", "the", " ", "algorithm"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "size", " ", "of", " ", 
      "the", " ", "in", " ", "silico", " ", 
      RowBox[{"dataset", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"objFunAlgorithm", "[", 
      RowBox[{
       RowBox[{"nCells_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"probDiv_", "?", "NumberQ"}], ",", " ", "probLab_", ",", " ", 
       "nFil_", ",", " ", "arc_", ",", " ", "trials_", ",", " ", "probsDat_", 
       ",", " ", "options_"}], "]"}], " ", ":=", " ", "\n", 
     RowBox[{
      RowBox[{"objFunAlgorithm", "[", 
       RowBox[{
       "nCells", ",", " ", "probDiv", ",", " ", "probLab", ",", " ", "nFil", 
        ",", " ", "arc", ",", " ", "trials", ",", " ", "probsDat", ",", " ", 
        "options"}], "]"}], " ", "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "fun", ",", " ", "simRes", ",", " ", "simSwitchLabFil", ",", " ", 
          "counterSim", ",", " ", "probsSim", ",", " ", "nLCList", ",", " ", 
          "sims"}], "}"}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"nLCList", " ", "=", " ", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"BinomialDistribution", "[", 
             RowBox[{"nCells", ",", " ", "probLab"}], "]"}], ",", " ", 
            "trials"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"sims", " ", "=", " ", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simulateBranchiaCells", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"nCells", "-", "#"}], ",", " ", "arc", ",", " ", 
               "probDiv", ",", " ", "nFil"}], "]"}], "&"}], ",", "nLCList"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"simRes", " ", "=", " ", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getFinalArc", "[", "#", "]"}], "&"}], ",", "sims"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"simSwitchLabFil", " ", "=", " ", 
          RowBox[{"countSwitchesLabFilData", "[", 
           RowBox[{"simRes", ",", "1"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "simulations", " ", "always", " ", "put", " ", "0", " ", "or", " ",
             "1", " ", "so", " ", "for", " ", "counting", " ", "switches", 
            " ", "in", " ", "simulations", " ", "look", " ", "for", " ", "0", 
            " ", "or", " ", "1"}], ",", " ", 
           RowBox[{"regardless", " ", "of", " ", "pattern"}]}], " ", "*)"}], 
         "\n", "\t", 
         RowBox[{"counterSim", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"simSwitchLabFil", ",", "#"}], "]"}], "&"}], "/@", 
           "options"}]}], ";", "\n", "\t", 
         RowBox[{"probsSim", " ", "=", " ", 
          RowBox[{"counterSim", "/", "trials"}]}], ";", "\n", "\t", 
         RowBox[{"fun", " ", "=", " ", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"probsSim", "-", "probsDat"}], ")"}], "^", "2"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"Return", "[", "fun", "]"}], ";"}]}], "\n", "]"}]}]}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", " ", "returning", " ", "the", " ", "sum"}], "-", 
      "of", "-", 
      RowBox[{"squres", " ", "objective", " ", "function"}]}], ",", " ", 
     RowBox[{
     "by", " ", "comparing", " ", "the", " ", "analytical", " ", 
      "probabilities", " ", "of", " ", "observing", " ", "the", " ", "pairs", 
      " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], "\n", "to", " ", "the", " ", 
      "frequencies", " ", "from", " ", 
      RowBox[{"data", ".", " ", "It"}], " ", "takes", " ", "as", " ", 
      "arguments", " ", "the", " ", "number", " ", "of", " ", "stem", " ", 
      "cells", " ", "nCells_"}], ",", " ", 
     RowBox[{"probability", " ", "of", " ", "division", " ", "probDiv_"}], 
     ",", "\n", 
     RowBox[{"labelling", " ", "efficiency", " ", "probLab_"}], ",", " ", 
     RowBox[{
     "the", " ", "frequencies", " ", "probsDat_", " ", "of", " ", "observing",
       " ", "pairs", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", "data"}], 
     ",", " ", "\n", 
     RowBox[{"with", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "options_", " ", 
      "corresponding", " ", "to", " ", "the", " ", "arch", " ", 
      "configurations", " ", "in", " ", "listFil_."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"objFunAnalytic", "[", 
      RowBox[{
       RowBox[{"nCells_", "?", "NumberQ"}], ",", 
       RowBox[{"probDiv_", "?", "NumberQ"}], ",", "probLab_", ",", 
       "probsDat_", ",", "listFil_", ",", "options_"}], "]"}], ":=", "  ", 
     RowBox[{
      RowBox[{"objFunAnalytic", "[", 
       RowBox[{
       "nCells", ",", " ", "probDiv", ",", " ", "probLab", ",", " ", 
        "probsDat", ",", " ", "listFil", ",", "options"}], "]"}], "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"probsSim", ",", " ", "fun"}], "}"}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"probsSim", " ", "=", " ", 
          RowBox[{"computeProbSF", "[", 
           RowBox[{
           "nCells", ",", "probDiv", ",", "probLab", ",", "listFil", ",", 
            "options"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"fun", " ", "=", " ", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"probsSim", "-", "probsDat"}], ")"}], "^", "2"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"temp", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"fun", ",", ".0000001"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nCells", ",", " ", "probDiv"}], "}"}]}], "}"}]}], ";", 
         "\n", "\t", 
         RowBox[{"Return", "[", "fun", "]"}], ";"}]}], "\n", "]"}]}]}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "an", " ", "initialization", " ", "cell"}], ",", 
     " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "automatically", " ", "run", " ", 
      "everytime"}], ",", " ", 
     RowBox[{"if", " ", "the", " ", "kernel", " ", "has", " ", "been", " ", 
      RowBox[{"cleared", "."}]}]}], " ", "*)"}]}]}]], "Code",
 CellChangeTimes->{
  3.6862993133490577`*^9, {3.6863010096951723`*^9, 3.6863010098342705`*^9}, {
   3.6863010568085065`*^9, 3.6863010712277184`*^9}, {3.686301119095584*^9, 
   3.686301134417438*^9}, {3.6863013267295284`*^9, 3.6863014065099735`*^9}, {
   3.6872694273991055`*^9, 3.6872694688936815`*^9}, {3.687277915948668*^9, 
   3.687277949051669*^9}, {3.6875144691520443`*^9, 3.687514553747261*^9}, {
   3.687514591853589*^9, 3.6875146158945627`*^9}, {3.6888068897967415`*^9, 
   3.6888070005036497`*^9}, {3.68880849085056*^9, 3.6888084949512997`*^9}, {
   3.6888147770552654`*^9, 3.688814784649338*^9}, {3.6888902602540627`*^9, 
   3.6888903109905806`*^9}, {3.6889697203736124`*^9, 3.688969857333889*^9}, {
   3.688969959573603*^9, 3.688969961011179*^9}, {3.6890750037647467`*^9, 
   3.6890750261496897`*^9}, {3.696141726066168*^9, 3.6961417595045013`*^9}, {
   3.6961420422703547`*^9, 3.6961420580138693`*^9}, {3.696142094928521*^9, 
   3.69614212482349*^9}, 3.6961421848645873`*^9, {3.6961425022515607`*^9, 
   3.696142567747307*^9}, {3.696142622330759*^9, 3.6961426559422083`*^9}, 
   3.6961426979832854`*^9, 3.6961427888539753`*^9, {3.696142907545247*^9, 
   3.696142907872468*^9}, {3.696148776874217*^9, 3.6961487949743032`*^9}, {
   3.6961488935281243`*^9, 3.696148897097508*^9}, {3.6963120345747476`*^9, 
   3.6963120377958984`*^9}, {3.7359797125876303`*^9, 3.735979894414178*^9}, {
   3.7359799301500654`*^9, 3.735980027720291*^9}, {3.7359879108729925`*^9, 
   3.7359879195447893`*^9}, {3.7359879547283087`*^9, 
   3.7359879891182985`*^9}, {3.735988023872532*^9, 3.735988029300158*^9}, {
   3.7361561904247456`*^9, 3.7361561971521907`*^9}, {3.7391600212659264`*^9, 
   3.7391601016887655`*^9}, {3.7391602767048397`*^9, 
   3.7391602808769255`*^9}, {3.7391604638282747`*^9, 
   3.7391604642516055`*^9}, {3.7391644229322844`*^9, 
   3.7391645467826743`*^9}, {3.739164598828995*^9, 3.7391646044417663`*^9}, {
   3.7391646480178924`*^9, 3.7391646634044905`*^9}, {3.7391648638595953`*^9, 
   3.739164896891214*^9}, {3.739164998142645*^9, 3.7391650650732746`*^9}, {
   3.7391651133131104`*^9, 3.7391651249544992`*^9}, {3.7391651607919283`*^9, 
   3.739165188313203*^9}, {3.7397852373509626`*^9, 3.739785293025861*^9}, {
   3.742206834239159*^9, 3.742206858907048*^9}, {3.7422071076187487`*^9, 
   3.7422071441761045`*^9}, {3.7422084316604223`*^9, 
   3.7422084336924057`*^9}, {3.7422086817611055`*^9, 3.742208833395626*^9}, {
   3.742210049258527*^9, 3.7422100672750545`*^9}, {3.742274410114832*^9, 
   3.742274453755432*^9}, {3.742277641588848*^9, 3.7422779434562244`*^9}, 
   3.742277983897499*^9, {3.7422794050516634`*^9, 3.742279443998451*^9}, {
   3.742279618010866*^9, 3.742279629193596*^9}, {3.7422796768855*^9, 
   3.7422796782193213`*^9}, {3.7422797524008164`*^9, 
   3.7422797804217596`*^9}, {3.742279816994588*^9, 3.7422798366346087`*^9}, {
   3.7422800216051655`*^9, 3.7422801837037563`*^9}, {3.742280214989646*^9, 
   3.742280238713627*^9}, {3.742280346158016*^9, 3.742280359525549*^9}, {
   3.742280400359064*^9, 3.7422804352010136`*^9}, {3.7422805267762394`*^9, 
   3.742280534025426*^9}, {3.742280634888649*^9, 3.742280669760105*^9}, {
   3.7422807109180365`*^9, 3.7422807232291174`*^9}, {3.742286646321417*^9, 
   3.742286646822444*^9}, {3.742286740817807*^9, 3.7422867609512196`*^9}, {
   3.7422867998266354`*^9, 3.742286804936387*^9}, {3.7427076628791237`*^9, 
   3.7427076640591817`*^9}, {3.7427078636690483`*^9, 3.742707864172346*^9}, {
   3.742707963628636*^9, 3.742707970431426*^9}, {3.7427080653461423`*^9, 
   3.7427080772757087`*^9}, {3.742708115574957*^9, 3.742708121490463*^9}, {
   3.7427081931150613`*^9, 3.742708199423061*^9}, {3.742720129270611*^9, 
   3.742720130239719*^9}, {3.7427201607110453`*^9, 3.742720192623592*^9}, {
   3.7427203223276243`*^9, 3.7427203323053913`*^9}, {3.7427205865235415`*^9, 
   3.742720622165558*^9}, {3.7807353012844887`*^9, 3.78073535962821*^9}, {
   3.7807355057259464`*^9, 3.780735549474347*^9}, {3.7807355840052104`*^9, 
   3.7807355920359535`*^9}, {3.780735641850043*^9, 3.7807356777579536`*^9}, {
   3.780735719945198*^9, 3.780736029661458*^9}, {3.7807360816775694`*^9, 
   3.7807360824119787`*^9}, {3.780737324411433*^9, 3.780737423180162*^9}, {
   3.7807379282560997`*^9, 3.780738531368497*^9}, {3.780738586992772*^9, 
   3.7807387902996607`*^9}, {3.780738863144834*^9, 3.7807393544112315`*^9}, {
   3.78074021905186*^9, 3.7807403434252863`*^9}, {3.780740382770852*^9, 
   3.780740720568257*^9}, {3.7807408462372184`*^9, 3.780740936206666*^9}, {
   3.780743850831583*^9, 3.780743879864176*^9}, {3.7807439331287994`*^9, 
   3.7807440558029857`*^9}, {3.7807440883513627`*^9, 
   3.7807442017715487`*^9}, {3.7808106472749834`*^9, 3.780810713793775*^9}, {
   3.78081125065532*^9, 3.780811428492856*^9}, {3.780811554910037*^9, 
   3.780811623799283*^9}, {3.784964637958332*^9, 3.7849647132972393`*^9}, {
   3.784964909041463*^9, 3.784965049278246*^9}, {3.784965098741618*^9, 
   3.7849651309088945`*^9}, {3.784965161442097*^9, 3.784965279478924*^9}, {
   3.784965330887724*^9, 3.7849656304634886`*^9}, {3.7849656744107037`*^9, 
   3.7849656947401524`*^9}, {3.7849657320098076`*^9, 3.784966012824069*^9}, {
   3.7849660453086247`*^9, 3.7849660458129587`*^9}, {3.784966076525273*^9, 
   3.7849661441929917`*^9}, {3.784966234653943*^9, 3.7849662965361533`*^9}, {
   3.7849663327270947`*^9, 3.7849666577326365`*^9}, {3.7849673942741437`*^9, 
   3.78496763295813*^9}, {3.7849676677921743`*^9, 3.784967672640382*^9}, {
   3.784967704712705*^9, 3.7849677313833523`*^9}, {3.7849677650806446`*^9, 
   3.7849678026705117`*^9}, {3.7849678397880325`*^9, 3.784967841660271*^9}, 
   3.784967988261999*^9, {3.7849680440278907`*^9, 3.7849681017391644`*^9}, {
   3.7857370232386217`*^9, 3.7857370405060453`*^9}, {3.785737083687611*^9, 
   3.7857372649062443`*^9}, {3.7857374159397593`*^9, 
   3.7857374197062488`*^9}, {3.785737492040103*^9, 3.7857374973015842`*^9}, {
   3.7857380928789835`*^9, 3.7857381431413097`*^9}, {3.7857381731901855`*^9, 
   3.785738201149234*^9}, {3.7857382349425917`*^9, 3.7857382429408827`*^9}, {
   3.7857383045156183`*^9, 3.7857383107714677`*^9}, {3.7857383513232937`*^9, 
   3.785738352818282*^9}, {3.7857383877974224`*^9, 3.785738390797406*^9}, {
   3.7857385148645215`*^9, 3.7857388142472153`*^9}, {3.785738846492546*^9, 
   3.7857388471169558`*^9}, {3.7857389109884453`*^9, 
   3.7857389640755663`*^9}, {3.7857390023538895`*^9, 3.785739012673716*^9}, {
   3.785739055706153*^9, 3.7857390862993937`*^9}, {3.785739239113001*^9, 
   3.7857393012084713`*^9}, {3.7857394378711343`*^9, 
   3.7857394460145235`*^9}, {3.785739523542633*^9, 3.7857395569647427`*^9}, {
   3.785740424522175*^9, 3.7857404523375783`*^9}, {3.785740485424011*^9, 
   3.785740513200384*^9}, {3.7857405883922176`*^9, 3.785740887658042*^9}, {
   3.785740935969*^9, 3.785740937455985*^9}, {3.785741001857478*^9, 
   3.785741061776116*^9}, {3.7857410941265717`*^9, 3.785741739398895*^9}, {
   3.7857417804359903`*^9, 3.7857419214264765`*^9}, {3.7857420455302916`*^9, 
   3.785742534225697*^9}, {3.785742574203144*^9, 3.7857426416954627`*^9}, {
   3.7857427017982235`*^9, 3.7857427267737455`*^9}, {3.7857427998523483`*^9, 
   3.785742800260618*^9}, {3.7857428354038672`*^9, 3.785742836298459*^9}, {
   3.785742871148105*^9, 3.785742893666002*^9}, {3.785743057305176*^9, 
   3.7857430593445253`*^9}, {3.785743745070351*^9, 3.7857442424495983`*^9}, {
   3.7857442745978656`*^9, 3.7857442957168365`*^9}, {3.785744393889577*^9, 
   3.785744460975393*^9}, {3.785753119713329*^9, 3.785753133122197*^9}, {
   3.785753219351241*^9, 3.7857533239174156`*^9}, {3.785754361985139*^9, 
   3.785754397328518*^9}, 3.7857545098009253`*^9, 3.7858266645426245`*^9, {
   3.7858269824601955`*^9, 3.7858270084924164`*^9}, 3.7858270406186695`*^9, 
   3.785827070679556*^9, {3.7858278938252993`*^9, 3.78582789441669*^9}, {
   3.7858291126188354`*^9, 3.785829140913553*^9}, {3.7858292112490025`*^9, 
   3.78582945828627*^9}, {3.785829620340746*^9, 3.7858296239971647`*^9}, {
   3.7858347560676193`*^9, 3.7858347636626434`*^9}, {3.7858348215943184`*^9, 
   3.785834823006253*^9}, {3.7858367401927414`*^9, 3.7858367646799393`*^9}, {
   3.785836931886468*^9, 3.7858369538529997`*^9}}],

Cell["3. Data import (>= 25 filaments)", "Program",
 CellChangeTimes->{{3.7397739640893545`*^9, 3.739773990889104*^9}, {
  3.7874828704679456`*^9, 3.787482870811718*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Import", " ", "final", " ", "datasets", " ", "for", " ", "each", " ", 
     "pattern", " ", "from", " ", 
     RowBox[{"file", ".", " ", "\n", "dataPatterned"}], " ", "has", " ", 
     RowBox[{"dimensions", " ", "[", 
      RowBox[{"4", ",", " ", "470", ",", "8"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "4"}], " ", "patterns"}], ",", " ", 
    RowBox[{
     RowBox[{"470", " ", "mini"}], "-", "arches"}], ",", " ", 
    RowBox[{
     RowBox[{"each", " ", "8"}], "-", 
     RowBox[{"filament", " ", 
      RowBox[{"long", "."}]}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPatterned", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<data/dataPatterned25minirev_\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "an", " ", "initialization", " ", "cell"}], ",", 
    " ", 
    RowBox[{
    "so", " ", "it", " ", "is", " ", "automatically", " ", "run", " ", 
     "everytime"}], ",", " ", 
    RowBox[{"if", " ", "the", " ", "kernel", " ", "has", " ", "been", " ", 
     RowBox[{"cleared", "."}]}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{
  3.739773981581098*^9, {3.7398549207753086`*^9, 3.739855029950662*^9}, {
   3.7398556326470985`*^9, 3.7398556603384485`*^9}, {3.740205146513387*^9, 
   3.740205147144805*^9}, {3.7801361583137636`*^9, 3.7801361930897675`*^9}, {
   3.780735122067727*^9, 3.780735133287299*^9}, {3.7807351776466985`*^9, 
   3.780735234039774*^9}, {3.7849645309779377`*^9, 3.784964569113166*^9}, {
   3.7857444450757136`*^9, 3.785744449155574*^9}, {3.785826495877491*^9, 
   3.7858265526045713`*^9}, {3.7858267199993086`*^9, 
   3.7858267830510206`*^9}, {3.785826816682271*^9, 3.785826903264549*^9}, {
   3.785826934401143*^9, 3.7858269388721023`*^9}, {3.7858273330196333`*^9, 
   3.785827435905917*^9}, {3.787478330518681*^9, 3.7874783369123683`*^9}}],

Cell["4. Parameter estimation (using the algortihmic approach)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.7857445540095563`*^9}, {
  3.787482874233741*^9, 3.7874828746243844`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimate", " ", "parameters", " ", "by", " ", "using", " ", "entire", " ",
     "data", " ", "set"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Get", " ", "the", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", " ",
       "for", " ", "a", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "s"}], "=", 
     RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
    RowBox[{"f", "=", 
     RowBox[{"number", " ", "of", " ", "labelled", " ", 
      RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"data", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqData", " ", "=", " ", 
     RowBox[{"computeFreqSF", "[", 
      RowBox[{"dataPatterned", ",", "pairOptions"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
     " ", "each", " ", 
     RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "temp", " ", "displays", " ", "the", " ", "current", " ", "estimate", " ",
      "dynamically", " ", "during", " ", "the", " ", "simulation", " ", 
     "run"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{"Dynamic", "[", "temp", "]"}], "\n", "\n", 
   RowBox[{"\"\<Computation started: \>\"", "<>", 
    RowBox[{"DateString", "[", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Minimize", " ", "the", " ", "objective", " ", "function", " ", "with", 
     " ", "respect", " ", "to", " ", "constraints"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "One", " ", "parameter", " ", "estimation", " ", "run", " ", "for", " ", 
     "one", " ", "pattern", " ", "takes", " ", "approximately", " ", "1", " ", 
     RowBox[{"minute", ".", "\n", "One"}], " ", "parameter", " ", 
     "estimation", " ", "run", " ", "for", " ", "all", " ", "4", " ", 
     "patterns", " ", "takes", " ", "approximately", " ", "5", " ", 
     RowBox[{"minutes", "."}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"resVal", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NMinimize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"objFunAlgorithm", "[", 
              RowBox[{"nSCE", ",", "probDivE", ",", 
               RowBox[{"probLab", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"freqData", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "listFilDistr", ",", 
               "pairOptions"}], "]"}], ",", 
             RowBox[{
              RowBox[{"nSCE", ">", "1"}], " ", "&&", " ", 
              RowBox[{"nSCE", "\[LessEqual]", "10"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"{", "nSCE", "}"}], "\[Element]", "Integers"}], " ", "&&",
               " ", 
              RowBox[{"probDivE", ">", "0.5"}], " ", "&&", " ", 
              RowBox[{"probDivE", "<", "1"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSCE", ",", " ", "probDivE"}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<NelderMead\>\"", ",", " ", 
              RowBox[{"\"\<RandomSeed\>\"", " ", "->", " ", "1"}]}], "}"}]}], 
           ",", " ", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"_", ",", "v_"}], "]"}], "\[RuleDelayed]", "v"}]}]}], ";"}], 
    "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "One", " ", "can", " ", "also", " ", "run", " ", "the", " ", "parameter",
       " ", "estimation", " ", "for", " ", "all", " ", "4", " ", "patterns"}],
      ",", " ", 
     RowBox[{"for", " ", "multiple", " ", "random", " ", "seeds"}], ",", " ", 
     RowBox[{
     "and", " ", "print", " ", "the", " ", "results", " ", "of", " ", "each", 
      " ", "such", " ", 
      RowBox[{"estimation", ".", " ", "Uncomment"}], " ", "below", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "RandomSeed"}], " ", "\[Element]", 
         " ", 
         RowBox[{"Range", "[", "10", "]"}]}], ")"}], "."}]}]}], " ", "*)"}], 
   "\n", 
   RowBox[{"res", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Pattern \>\"", ",", "j", ",", "\"\<: \>\"", ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"objFunAlgorithm", "[", 
               RowBox[{"nSCE", ",", "probDivE", ",", 
                RowBox[{"probLab", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"freqData", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "listFilDistr", ",", 
                "pairOptions"}], "]"}], ",", 
              RowBox[{
               RowBox[{"nSCE", ">", "1"}], " ", "&&", " ", 
               RowBox[{"nSCE", "\[LessEqual]", "10"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"{", "nSCE", "}"}], "\[Element]", "Integers"}], " ", "&&",
                " ", 
               RowBox[{"probDivE", ">", "0.5"}], " ", "&&", " ", 
               RowBox[{"probDivE", "<", "1"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nSCE", ",", " ", "probDivE"}], "}"}], ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<NelderMead\>\"", ",", " ", 
               RowBox[{"\"\<RandomSeed\>\"", " ", "->", " ", "i"}]}], "}"}]}],
             ",", " ", 
            RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "\n", 
   RowBox[{"\"\<Computation finished: \>\"", "<>", 
    RowBox[{"DateString", "[", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.787464362274426*^9, 3.7874644366695566`*^9}, {
  3.787481070363818*^9, 3.7874811465560465`*^9}}],

Cell["5. Parameter estimation (using the analytic approach)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744564737661*^9}, {
  3.787482878155797*^9, 3.787482878562066*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimate", " ", "parameters", " ", "by", " ", "using", " ", "entire", " ",
     "data", " ", "set"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Get", " ", "the", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", " ",
       "for", " ", "a", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "s"}], "=", 
     RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
    RowBox[{"f", "=", 
     RowBox[{"number", " ", "of", " ", "labelled", " ", 
      RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"data", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqData", " ", "=", " ", 
     RowBox[{
      RowBox[{"computeFreqSF", "[", 
       RowBox[{"dataPatterned", ",", "pairOptions"}], "]"}], "*", "1."}]}], 
    ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
     " ", "each", " ", 
     RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "temp", " ", "displays", " ", "the", " ", "current", " ", "estimate", " ",
      "dynamically", " ", "during", " ", "the", " ", "simulation", " ", 
     "run"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{"Dynamic", "[", "temp", "]"}], "\n", "\n", 
   RowBox[{"\"\<Computation started: \>\"", "<>", 
    RowBox[{"DateString", "[", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Minimize", " ", "the", " ", "objective", " ", "function", " ", "with", 
     " ", "respect", " ", "to", " ", "constraints"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "One", " ", "parameter", " ", "estimation", " ", "run", " ", "for", " ", 
     "one", " ", "pattern", " ", "takes", " ", "approximately", " ", "1", " ", 
     RowBox[{"minute", ".", "\n", "One"}], " ", "parameter", " ", 
     "estimation", " ", "run", " ", "for", " ", "all", " ", "4", " ", 
     "patterns", " ", "takes", " ", "approximately", " ", "5", " ", 
     RowBox[{"minutes", "."}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"resVal", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NMinimize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"objFunAnalytic", "[", 
              RowBox[{"nSCE", ",", "probDivE", ",", 
               RowBox[{"probLab", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"freqData", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "listFilDistr", ",", 
               "pairOptions"}], "]"}], ",", 
             RowBox[{
              RowBox[{"nSCE", ">", "1"}], " ", "&&", " ", 
              RowBox[{"nSCE", "\[LessEqual]", "10"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"{", "nSCE", "}"}], "\[Element]", "Integers"}], " ", "&&",
               " ", 
              RowBox[{"probDivE", ">", "0.5"}], " ", "&&", " ", 
              RowBox[{"probDivE", "<", "1"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSCE", ",", " ", "probDivE"}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<NelderMead\>\"", ",", " ", 
              RowBox[{"\"\<RandomSeed\>\"", " ", "->", " ", "1"}]}], "}"}]}], 
           ",", " ", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"_", ",", "v_"}], "]"}], "\[RuleDelayed]", "v"}]}]}], ";"}], 
    "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "One", " ", "can", " ", "also", " ", "run", " ", "the", " ", "parameter",
       " ", "estimation", " ", "for", " ", "all", " ", "4", " ", "patterns"}],
      ",", " ", 
     RowBox[{"for", " ", "multiple", " ", "random", " ", "seeds"}], ",", " ", 
     RowBox[{
     "and", " ", "print", " ", "the", " ", "results", " ", "of", " ", "each", 
      " ", "such", " ", 
      RowBox[{"estimation", ".", " ", "Uncomment"}], " ", "below", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "RandomSeed"}], " ", "\[Element]", 
         " ", 
         RowBox[{"Range", "[", "10", "]"}]}], ")"}], "."}]}]}], " ", "*)"}], 
   "\n", 
   RowBox[{"res", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Pattern \>\"", ",", "j", ",", "\"\<: \>\"", ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"objFunAnalytic", "[", 
               RowBox[{"nSCE", ",", "probDivE", ",", 
                RowBox[{"probLab", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"freqData", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "listFilDistr", ",", 
                "pairOptions"}], "]"}], ",", 
              RowBox[{
               RowBox[{"nSCE", ">", "1"}], " ", "&&", " ", 
               RowBox[{"nSCE", "\[LessEqual]", "10"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"{", "nSCE", "}"}], "\[Element]", "Integers"}], " ", "&&",
                " ", 
               RowBox[{"probDivE", ">", "0.5"}], " ", "&&", " ", 
               RowBox[{"probDivE", "<", "1"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nSCE", ",", " ", "probDivE"}], "}"}], ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<NelderMead\>\"", ",", " ", 
               RowBox[{"\"\<RandomSeed\>\"", " ", "->", " ", "i"}]}], "}"}]}],
             ",", " ", 
            RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "\n", 
   RowBox[{"\"\<Computation finished: \>\"", "<>", 
    RowBox[{"DateString", "[", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.785744690686735*^9, 3.785744716275663*^9}, {
   3.7857447612687893`*^9, 3.7857448241670485`*^9}, {3.785744871111105*^9, 
   3.7857449004545183`*^9}, {3.785752997022162*^9, 3.785753055372763*^9}, {
   3.785753140011753*^9, 3.785753145203189*^9}, {3.785826343423766*^9, 
   3.7858264545901785`*^9}, {3.7858277353183136`*^9, 3.785827771445213*^9}, {
   3.785827813542061*^9, 3.7858278465640335`*^9}, {3.785827921652707*^9, 
   3.785827955867342*^9}, {3.785828198311894*^9, 3.785828308439416*^9}, {
   3.785828428111734*^9, 3.7858285098127584`*^9}, {3.785828544662809*^9, 
   3.785828554668432*^9}, {3.7858287022846475`*^9, 3.7858287044670906`*^9}, {
   3.7858353291743975`*^9, 3.785835346459832*^9}, {3.785835549713744*^9, 
   3.7858356041917863`*^9}, {3.7858361292376623`*^9, 
   3.7858361310028276`*^9}, {3.7858364169424953`*^9, 
   3.7858364334864397`*^9}, {3.7858366210742598`*^9, 
   3.7858367198666143`*^9}, {3.785836773818986*^9, 3.785836776962065*^9}, {
   3.785836852088679*^9, 3.7858368675439034`*^9}, {3.7858369043772697`*^9, 
   3.785836906767851*^9}, {3.7858369660880003`*^9, 3.7858369748467913`*^9}, {
   3.7858370608212643`*^9, 3.7858370928365383`*^9}, {3.7858372092287407`*^9, 
   3.7858372237383394`*^9}, {3.78583738169366*^9, 3.7858373997125797`*^9}, {
   3.785837573815283*^9, 3.7858375764550285`*^9}, {3.785837654302141*^9, 
   3.7858377164443407`*^9}, {3.785838080840129*^9, 3.785838083711595*^9}, {
   3.7858382073428645`*^9, 3.785838290205871*^9}, {3.7858383536218233`*^9, 
   3.7858383560444255`*^9}, {3.785838668545601*^9, 3.785838675680321*^9}, {
   3.785838712328565*^9, 3.7858387124796658`*^9}, {3.785839260104599*^9, 
   3.785839283087803*^9}, {3.785839325479847*^9, 3.785839405078285*^9}, {
   3.785839507374222*^9, 3.7858395301572957`*^9}, {3.785841239936282*^9, 
   3.785841467339517*^9}, {3.7858415028309937`*^9, 3.7858415091161537`*^9}, 
   3.787464424508556*^9, {3.7874698991114683`*^9, 3.7874698996114798`*^9}, {
   3.7874699624246297`*^9, 3.7874699782897167`*^9}, {3.787471053376088*^9, 
   3.7874710867284336`*^9}, {3.7874717198210726`*^9, 3.787471770397015*^9}, {
   3.7874718104254203`*^9, 3.78747186130674*^9}, {3.787481050994804*^9, 
   3.7874810559867315`*^9}, {3.7874811528375764`*^9, 3.7874811533532257`*^9}}],

Cell["6. In silico data generation (homogeneous model)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744592601085*^9}, {
  3.7858262835761766`*^9, 3.785826289488086*^9}, {3.7874828823278646`*^9, 
  3.787482917089056*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"probLab", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"getLabelEfficiencyPattern", "[", 
       RowBox[{
        RowBox[{"dataPatterned", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Simulate", " ", "the", " ", "progenitor", " ", "and", " ", "the", " ", 
     "stem", " ", "models"}], ",", " ", 
    RowBox[{
    "for", " ", "each", " ", "of", " ", "the", " ", "4", " ", "labelling", 
     " ", "efficiencies"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"simProg", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"simulateProgenitor", "[", 
      RowBox[{
       RowBox[{"probLab", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
       RowBox[{"10", "^", "4"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"simStem", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"simulateStem", "[", 
       RowBox[{
        RowBox[{"probLab", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
        RowBox[{"10", "^", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "simulating", " ", "a", " ", "homogeneous", " ", "model", " ",
      "with", " ", "more", " ", "than", " ", "one", " ", "stem", " ", 
     "cells"}], ",", " ", 
    RowBox[{
    "simply", " ", "use", " ", "the", " ", "function", " ", "for", " ", "the",
      " ", "heterogeneous", " ", "model"}], ",", " ", "\n", 
    RowBox[{
     RowBox[{"with", " ", "probDiv"}], "=", 
     RowBox[{"0.5", " ", 
      RowBox[{"(", 
       RowBox[{
       "equal", " ", "probabilities", " ", "for", " ", "the", " ", "same", 
        " ", "cell", " ", "to", " ", "divide", " ", "again", " ", "or", " ", 
        "a", " ", "new", " ", "one"}], ")"}]}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sim2SC", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"simulateBranchiaPattern", "[", 
       RowBox[{"2", ",", " ", "0.5", ",", " ", 
        RowBox[{"probLab", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", "8", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"10", "^", "4"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Export", " ", "in", " ", "silico", " ", "data"}], ",", " ", 
    RowBox[{"for", " ", "stem"}], ",", " ", 
    RowBox[{
    "progenitor", " ", "and", " ", "homogeneous", " ", "model", " ", "with", 
     " ", "2", " ", "stem", " ", "cells"}], ",", "\n", 
    RowBox[{
    "using", " ", "the", " ", "labelling", " ", "efficiencies", " ", "from", 
     " ", "each", " ", 
     RowBox[{"pattern", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<simulations/homogeneousModel/simProg\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], ",", 
      RowBox[{"simProg", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<simulations/homogeneousModel/simStem\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], ",", 
      RowBox[{"simStem", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"\"\<simulations/homogeneousModel/simHomog2SC\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], ",", 
       RowBox[{"sim2SC", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
     "cell"}], ",", " ", 
    RowBox[{"so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
     RowBox[{"run", "."}]}]}], " ", "*)"}]}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.7858409502749615`*^9, 3.785840964465351*^9}, {
   3.785840996113284*^9, 3.7858411894227595`*^9}, {3.7874658297338333`*^9, 
   3.78746594929205*^9}, 3.787466008987953*^9, {3.7874783563664002`*^9, 
   3.7874783974798822`*^9}, {3.7874784523516536`*^9, 
   3.7874784566956043`*^9}, {3.787479365538993*^9, 3.787479365945258*^9}, {
   3.7874811563377385`*^9, 3.7874811568221354`*^9}}],

Cell["7. In silico data generation (heterogeneous model)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744592601085*^9}, {
  3.7858262835761766`*^9, 3.785826302487688*^9}, {3.7874828951809297`*^9, 
  3.7874829217142773`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"probLab", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"getLabelEfficiencyPattern", "[", 
       RowBox[{
        RowBox[{"dataPatterned", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Stem", " ", "cell", " ", "numbers"}], ",", " ", "nCells", ",", 
    " ", 
    RowBox[{
    "with", " ", "values", " ", "estimated", " ", "using", " ", "the", " ", 
     "analytical", " ", "probabilities"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
     "objFunAnalytic"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nCells", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4", ",", "2", ",", "2"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
     "results"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "nCells"}], " ", "=", " ", 
      RowBox[{"resVal", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "2", ",", "1"}], "]"}], "]"}]}], ";"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Probability", " ", "of", " ", "division", " ", "probDiv", " ", "values", 
     " ", "estimated", " ", "using", " ", "the", " ", "analytical", " ", 
     "probabilities"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
     "objFunAnalytic"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"probDiv", "=", 
    RowBox[{"{", 
     RowBox[{"0.9189", ",", "0.7787", ",", "0.9553", ",", "0.902"}], "}"}]}], 
   ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
      "results"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "probDiv"}], " ", "=", " ", 
       RowBox[{"resVal", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simulate", " ", 
      RowBox[{"patterns", ":", " ", 
       RowBox[{
        RowBox[{
        "Simulate", " ", "in", " ", "silico", " ", "data", " ", "sets", " ", 
         "of", " ", 
         RowBox[{"10", "^", "5"}], " ", "8"}], "-", 
        RowBox[{"filament", " ", "long", " ", "mini"}], "-", "arches"}]}]}], 
     ",", " ", 
     RowBox[{
     "for", " ", "each", " ", "of", " ", "the", " ", "four", " ", 
      "patterns"}], ",", " ", 
     RowBox[{
     "having", " ", "parameters", "\n", "nCells", " ", "and", " ", "probDiv", 
      " ", "estimated", " ", "above"}], ",", " ", 
     RowBox[{
     "and", " ", "probLab", " ", "approximated", " ", "from", " ", "the", " ", 
      RowBox[{"data", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{"simPatterned", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"simulateBranchiaPattern", "[", 
       RowBox[{
        RowBox[{"nCells", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
        RowBox[{"probDiv", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
        RowBox[{"probLab", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", "8", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"10", "^", "5"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Export", " ", "in", " ", "silico", " ", "data"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"\"\<simulations/heterogeneousModel/simPatterned\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], ",", 
       RowBox[{"simPatterned", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
     "cell"}], ",", " ", 
    RowBox[{"so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
     RowBox[{"run", "."}]}]}], " ", "*)"}]}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.6863011423020163`*^9, 3.686301169223049*^9}, {
   3.6863013903255277`*^9, 3.6863015282271433`*^9}, {3.686301565655615*^9, 
   3.6863015722552857`*^9}, {3.6863016733061037`*^9, 3.686301675042341*^9}, {
   3.6863017229092083`*^9, 3.6863019329408607`*^9}, {3.6863027310539703`*^9, 
   3.686302733935012*^9}, {3.686302873760641*^9, 3.6863028809807415`*^9}, {
   3.687267122504374*^9, 3.6872672118847747`*^9}, {3.687267403417057*^9, 
   3.6872674047449408`*^9}, {3.6872674683852334`*^9, 
   3.6872675569600964`*^9}, {3.6872691522232323`*^9, 
   3.6872691533049526`*^9}, {3.6872692143034897`*^9, 
   3.6872692174866076`*^9}, {3.696311415395216*^9, 3.69631148090197*^9}, 
   3.6963115111631775`*^9, {3.7059136022917795`*^9, 3.7059136239472427`*^9}, {
   3.7059795051465473`*^9, 3.705979558512846*^9}, {3.7059873783581605`*^9, 
   3.70598739704434*^9}, {3.7059960628773146`*^9, 3.7059960767080765`*^9}, {
   3.7391597916727777`*^9, 3.739159798859427*^9}, {3.739164680678388*^9, 
   3.7391646833664184`*^9}, {3.739246768973592*^9, 3.7392467890198865`*^9}, {
   3.742273661682649*^9, 3.742273662010791*^9}, {3.7422737208574934`*^9, 
   3.7422737552810893`*^9}, {3.7422868497605143`*^9, 
   3.7422869636732635`*^9}, {3.7427071258804674`*^9, 
   3.7427071331612616`*^9}, {3.7427193365897417`*^9, 3.742719337500203*^9}, {
   3.7427200679993815`*^9, 3.7427200681400137`*^9}, {3.74272365823964*^9, 
   3.742723660938702*^9}, {3.742724890512947*^9, 3.742724899258465*^9}, {
   3.742893370631141*^9, 3.7428933931623917`*^9}, {3.7801397035796385`*^9, 
   3.780139707411173*^9}, {3.780289656556324*^9, 3.7802896570094604`*^9}, {
   3.781525955549734*^9, 3.781525962131085*^9}, {3.7820213440166693`*^9, 
   3.782021346712453*^9}, {3.782025609519424*^9, 3.7820256130147367`*^9}, {
   3.783839137823226*^9, 3.7838391865095987`*^9}, {3.783839472290557*^9, 
   3.7838395024496784`*^9}, {3.7838395420980177`*^9, 3.783839548417189*^9}, {
   3.7838398132457647`*^9, 3.783839970547573*^9}, {3.783840190632627*^9, 
   3.7838401969048457`*^9}, {3.7838403144380026`*^9, 3.783840371782982*^9}, {
   3.783842458401591*^9, 3.7838425244782057`*^9}, {3.783842590326624*^9, 
   3.7838426083926744`*^9}, {3.7838426570618076`*^9, 
   3.7838426618276615`*^9}, {3.7858378213706446`*^9, 
   3.7858379922000847`*^9}, {3.7858384329547668`*^9, 
   3.7858384793544626`*^9}, {3.7858385165050383`*^9, 
   3.7858386294720507`*^9}, {3.7858394458293753`*^9, 
   3.7858395005647197`*^9}, {3.7858395656757884`*^9, 3.785839586331455*^9}, {
   3.785839728153788*^9, 3.7858398450003643`*^9}, {3.7858406599265366`*^9, 
   3.7858407077416315`*^9}, {3.7858407464942675`*^9, 3.7858408172594185`*^9}, 
   3.7858408510767903`*^9, {3.785841223902566*^9, 3.7858412259659343`*^9}, {
   3.787478376040907*^9, 3.787478401339428*^9}, {3.787479231302903*^9, 
   3.7874792448516*^9}, {3.7874811592910085`*^9, 3.787481159837908*^9}}],

Cell["8. Parametric colour plots", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744564737661*^9}, {
  3.7857446000570173`*^9, 3.7857446361208715`*^9}, {3.787482926372246*^9, 
  3.787482930682786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Get", " ", "the", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", " ",
       "for", " ", "a", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "s"}], "=", 
     RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
    RowBox[{"f", "=", 
     RowBox[{"number", " ", "of", " ", "labelled", " ", 
      RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"data", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqData", " ", "=", " ", 
     RowBox[{"computeFreqSF", "[", 
      RowBox[{"dataPatterned", ",", "pairOptions"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
     " ", "each", " ", 
     RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Define", " ", "the", " ", "ranges", " ", "for", " ", "the", " ", 
      "parameters", " ", "n", " ", "and", " ", "p"}], ",", " ", 
     RowBox[{
     "for", " ", "the", " ", "parametric", " ", "colour", " ", "plot"}]}], 
    "  ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tryNcells", " ", "=", " ", 
     RowBox[{"Range", "[", "10", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tryProbDiv", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"0.5", ",", "1", ",", "0.05"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tryPlotParameters", " ", "=", " ", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"tryNcells", ",", "tryProbDiv"}], "}"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Pattern", " ", "1"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "objective", " ", "function", " ", "at", " ", 
     "each", " ", "point", " ", "in", " ", "the", " ", "parametric", " ", 
     "space"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"objFun1", " ", "=", " ", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"objFunAnalytic", "[", 
          RowBox[{"#1", ",", "#2", ",", 
           RowBox[{"probLab", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"freqData", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "listFilDistr", ",", 
           "pairOptions"}], "]"}], ")"}], "&"}], ",", " ", 
       "tryPlotParameters", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Creat", " ", "list", " ", "with", " ", "entries", " ", "n"}], 
     ",", " ", "p", ",", " ", 
     RowBox[{
     "and", " ", "logarithm", " ", "of", " ", "objective", " ", "function", 
      " ", "value", " ", "at", " ", "point", " ", 
      RowBox[{"(", 
       RowBox[{"n", ",", "p"}], ")"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"toPlotLog1", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"tryPlotParameters", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"objFun1", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", "1000"}], "]"}]}], "]"}], 
       "&"}], "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "objFun1", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "the", " ", "parametric", " ", "colour", " ", "map", " ", 
     RowBox[{"(", "ListDensityPlot", ")"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"paramPlotLog1", " ", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"toPlotLog1", ",", " ", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Pattern 1\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"BaseStyle", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontWeight", " ", "->", " ", "\"\<Bold\>\""}], ",", " ", 
          RowBox[{"FontSize", " ", "->", " ", "20"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Number of Cells\>\"", ",", " ", 
          "\"\<Probability of Division\>\""}], "}"}]}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Do", " ", "the", " ", "same", " ", "for", " ", "all", " ", "4", " ", 
     "patterns"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Pattern", " ", "2"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "objective", " ", "function", " ", "at", " ", 
     "each", " ", "point", " ", "in", " ", "the", " ", "parametric", " ", 
     "space"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"objFun2", " ", "=", " ", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"objFunAnalytic", "[", 
          RowBox[{"#1", ",", "#2", ",", 
           RowBox[{"probLab", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"freqData", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "listFilDistr", ",", 
           "pairOptions"}], "]"}], ")"}], "&"}], ",", " ", 
       "tryPlotParameters", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Creat", " ", "list", " ", "with", " ", "entries", " ", "n"}], 
     ",", " ", "p", ",", " ", 
     RowBox[{
     "and", " ", "logarithm", " ", "of", " ", "objective", " ", "function", 
      " ", "value", " ", "at", " ", "point", " ", 
      RowBox[{"(", 
       RowBox[{"n", ",", "p"}], ")"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"toPlotLog2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"tryPlotParameters", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"objFun2", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", "1000"}], "]"}]}], "]"}], 
       "&"}], "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "objFun2", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "the", " ", "parametric", " ", "colour", " ", "map", " ", 
     RowBox[{"(", "ListDensityPlot", ")"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"paramPlotLog2", " ", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"toPlotLog2", ",", " ", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Pattern 2\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"BaseStyle", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontWeight", " ", "->", " ", "\"\<Bold\>\""}], ",", " ", 
          RowBox[{"FontSize", " ", "->", " ", "20"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Number of Cells\>\"", ",", " ", 
          "\"\<Probability of Division\>\""}], "}"}]}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Pattern", " ", "3"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "objective", " ", "function", " ", "at", " ", 
     "each", " ", "point", " ", "in", " ", "the", " ", "parametric", " ", 
     "space"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"objFun3", " ", "=", " ", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"objFunAnalytic", "[", 
          RowBox[{"#1", ",", "#2", ",", 
           RowBox[{"probLab", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"freqData", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "listFilDistr", ",", 
           "pairOptions"}], "]"}], ")"}], "&"}], ",", " ", 
       "tryPlotParameters", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Creat", " ", "list", " ", "with", " ", "entries", " ", "n"}], 
     ",", " ", "p", ",", " ", 
     RowBox[{
     "and", " ", "logarithm", " ", "of", " ", "objective", " ", "function", 
      " ", "value", " ", "at", " ", "point", " ", 
      RowBox[{"(", 
       RowBox[{"n", ",", "p"}], ")"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"toPlotLog3", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"tryPlotParameters", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"objFun3", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", "1000"}], "]"}]}], "]"}], 
       "&"}], "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "objFun3", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "the", " ", "parametric", " ", "colour", " ", "map", " ", 
     RowBox[{"(", "ListDensityPlot", ")"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"paramPlotLog3", " ", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"toPlotLog3", ",", " ", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Pattern 3\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"BaseStyle", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontWeight", " ", "->", " ", "\"\<Bold\>\""}], ",", " ", 
          RowBox[{"FontSize", " ", "->", " ", "20"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Number of Cells\>\"", ",", " ", 
          "\"\<Probability of Division\>\""}], "}"}]}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Pattern", " ", "4"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "objective", " ", "function", " ", "at", " ", 
     "each", " ", "point", " ", "in", " ", "the", " ", "parametric", " ", 
     "space"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"objFun4", " ", "=", " ", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"objFunAnalytic", "[", 
          RowBox[{"#1", ",", "#2", ",", 
           RowBox[{"probLab", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"freqData", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", "listFilDistr", ",", 
           "pairOptions"}], "]"}], ")"}], "&"}], ",", " ", 
       "tryPlotParameters", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Creat", " ", "list", " ", "with", " ", "entries", " ", "n"}], 
     ",", " ", "p", ",", " ", 
     RowBox[{
     "and", " ", "logarithm", " ", "of", " ", "objective", " ", "function", 
      " ", "value", " ", "at", " ", "point", " ", 
      RowBox[{"(", 
       RowBox[{"n", ",", "p"}], ")"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"toPlotLog4", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"tryPlotParameters", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"objFun4", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", "1000"}], "]"}]}], "]"}], 
       "&"}], "/@", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "objFun4", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "the", " ", "parametric", " ", "colour", " ", "map", " ", 
     RowBox[{"(", "ListDensityPlot", ")"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"paramPlotLog4", " ", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"toPlotLog1", ",", " ", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Pattern 4\>\""}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"BaseStyle", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontWeight", " ", "->", " ", "\"\<Bold\>\""}], ",", " ", 
          RowBox[{"FontSize", " ", "->", " ", "20"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Number of Cells\>\"", ",", " ", 
          "\"\<Probability of Division\>\""}], "}"}]}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Export", " ", "the", " ", "4", " ", "parametric", " ", "plots", " ", 
     "in", " ", "pdf", " ", "and", " ", "svg", " ", "formats"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt1.pdf\>\"", ",", "paramPlotLog1"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt1.svg\>\"", ",", "paramPlotLog1"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt2.pdf\>\"", ",", "paramPlotLog2"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt2.svg\>\"", ",", "paramPlotLog2"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt3.pdf\>\"", ",", "paramPlotLog3"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt3.svg\>\"", ",", "paramPlotLog3"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt4.pdf\>\"", ",", "paramPlotLog4"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/ParametricPlotLog_Patt4.svg\>\"", ",", "paramPlotLog4"}], 
     "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.78739113148536*^9, 3.7873911471879315`*^9}, {
   3.787391225729558*^9, 3.7873913090898986`*^9}, 3.7873916550622997`*^9, {
   3.7874636680983744`*^9, 3.7874636725517015`*^9}, {3.787463739583679*^9, 
   3.7874637538038516`*^9}, {3.7874637931756372`*^9, 
   3.7874642913478236`*^9}, {3.787464323449267*^9, 3.787464344311451*^9}, {
   3.7874649655414257`*^9, 3.787465023318362*^9}, {3.787478469622282*^9, 
   3.7874785147999372`*^9}, {3.787481163431815*^9, 3.7874811639474645`*^9}, {
   3.7874811941438246`*^9, 3.7874811942219534`*^9}, {3.787483022989688*^9, 
   3.7874830279290476`*^9}}],

Cell["9. Stacked plots (homogeneous model)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744564737661*^9}, {
  3.785744628144597*^9, 3.785744631809021*^9}, {3.7874654161208563`*^9, 
  3.7874654409953003`*^9}, {3.787479306541189*^9, 3.7874793087600417`*^9}, {
  3.7874829362782106`*^9, 3.787482936950105*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
    " ", "each", " ", 
    RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Import", " ", "homogeneous", " ", "in", " ", "silico", " ", "data"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simHomog", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"\"\<simulations/homogeneousModel/simHomog2SC\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"simStem", " ", "=", " ", 
     RowBox[{
     "Import", "[", "\"\<simulations/homogeneousModel/simStem1.csv\>\"", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"simProg", " ", "=", " ", 
     RowBox[{
     "Import", "[", "\"\<simulations/homogeneousModel/simProg1.csv\>\"", 
      "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Get", " ", "the", " ", 
       RowBox[{"(", 
        RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", 
       " ", "for", " ", "a", " ", "mini"}], "-", 
      RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
     RowBox[{
      RowBox[{"with", " ", "s"}], "=", 
      RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
     RowBox[{"f", "=", 
      RowBox[{"number", " ", "of", " ", "labelled", " ", 
       RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"simulations", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqSim", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1.", "*", 
        RowBox[{"computeFreqSFPattern", "[", 
         RowBox[{
          RowBox[{"simHomog", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", "1", ",", "pairOptions"}], 
         "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"freqStem", " ", "=", " ", 
     RowBox[{"1.", "*", 
      RowBox[{"computeFreqSFPattern", "[", 
       RowBox[{"simStem", ",", "1", ",", "pairOptions"}], "]"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"freqProg", " ", "=", " ", 
     RowBox[{"1.", "*", 
      RowBox[{"computeFreqSFPattern", "[", 
       RowBox[{"simProg", ",", "1", ",", "pairOptions"}], "]"}]}]}], ";"}], 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "the", " ", "stscked", " ", "plots", " ", "for", " ", 
     "each", " ", "pattern"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt1Homog", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       "barLegendSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "1", "]"}], "<>", 
        "\"\<: n = 2, LabEff = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"probLab", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt2Homog", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       "barLegendSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "2", "]"}], "<>", 
        "\"\<: n = 2, LabEff = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"probLab", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt3Homog", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       "barLegendSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "3", "]"}], "<>", 
        "\"\<: n = 2, LabEff = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"probLab", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt4Homog", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       "barLegendSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "4", "]"}], "<>", 
        "\"\<: n = 2, LabEff = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"probLab", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Export", " ", "the", " ", "4", " ", "plots", " ", "in", " ", "pdf", " ", 
     "and", " ", "svg", " ", "formats"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt1.pdf\>\"", ",", 
      "plotStackedPatt1Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt1.svg\>\"", ",", 
      "plotStackedPatt1Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt2.pdf\>\"", ",", 
      "plotStackedPatt2Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt2.svg\>\"", ",", 
      "plotStackedPatt2Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt3.pdf\>\"", ",", 
      "plotStackedPatt3Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt3.svg\>\"", ",", 
      "plotStackedPatt3Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt4.pdf\>\"", ",", 
      "plotStackedPatt4Homog"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlotHomog2SC_Patt4.svg\>\"", ",", 
      "plotStackedPatt4Homog"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Also", " ", "plot", " ", "the", " ", "results", " ", "of", " ", "the", 
      " ", "stem", " ", "and", " ", "progenitor", " ", "models"}], ",", " ", 
     RowBox[{
     "only", " ", "for", " ", "labelling", " ", "efficiency", " ", "of", " ", 
      "pattern", " ", "1"}], ",", " ", 
     RowBox[{"as", " ", 
      RowBox[{"example", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedStem", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
      "freqStem", ",", "colorSchemeBlue", ",", "barLegendSchemeBlue", ",", 
       "\"\<Stem cell model (LabEff = 0.1553)\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedProg", " ", "=", " ", 
     RowBox[{"plotStackedChartSingle", "[", 
      RowBox[{
      "freqProg", ",", "colorSchemeBlue", ",", "barLegendSchemeBlue", ",", 
       "\"\<Progenitor model (LabEff = 0.1553)\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlot1SC.pdf\>\"", ",", 
      "plotStackedStem"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlot1SC.svg\>\"", ",", 
      "plotStackedStem"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlot8Prog.pdf\>\"", ",", 
      "plotStackedProg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/homogeneousModel/StackedPlot8Prog.svg\>\"", ",", 
      "plotStackedProg"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.7874644669579625`*^9, 3.7874645263696012`*^9}, {
   3.7874645609606977`*^9, 3.787464597089012*^9}, {3.7874646465055294`*^9, 
   3.787464732349018*^9}, {3.787464772226631*^9, 3.78746496172738*^9}, {
   3.7874654682975826`*^9, 3.7874656100265408`*^9}, {3.787465697479477*^9, 
   3.7874657212322116`*^9}, {3.7874679878416443`*^9, 
   3.7874680135188613`*^9}, {3.7874680444483376`*^9, 3.787468070989992*^9}, {
   3.7874681200720563`*^9, 3.7874681531495066`*^9}, {3.787468285003358*^9, 
   3.787468289000535*^9}, {3.787468579267725*^9, 3.7874685843026304`*^9}, {
   3.7874686239907565`*^9, 3.7874686294597583`*^9}, {3.787478522081521*^9, 
   3.787478549900812*^9}, {3.78747858431107*^9, 3.787478611120149*^9}, {
   3.787479076868352*^9, 3.7874790845881476`*^9}, {3.7874792182085457`*^9, 
   3.787479222427493*^9}, 3.787479349349447*^9, {3.787479382230319*^9, 
   3.787479810729558*^9}, {3.7874798492670937`*^9, 3.7874800351476693`*^9}, {
   3.787480107900809*^9, 3.7874802552753954`*^9}, {3.787480397098137*^9, 
   3.787480428882736*^9}, {3.7874805197717648`*^9, 3.78748059629751*^9}, {
   3.7874806288477025`*^9, 3.787480657118414*^9}, {3.787480745432124*^9, 
   3.787480756442278*^9}, {3.787481166902582*^9, 3.787481167402605*^9}}],

Cell["\<\
10. Stacked plots (heterogeneous model, algorithmic approach)\
\>", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744564737661*^9}, {
  3.785744628144597*^9, 3.785744631809021*^9}, {3.7874654161208563`*^9, 
  3.7874654409953003`*^9}, {3.787479311807062*^9, 3.787479316104741*^9}, {
  3.7874829413253064`*^9, 3.78748294255974*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
    " ", "each", " ", 
    RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Stem", " ", "cell", " ", "numbers"}], ",", " ", "nCells", ",", 
     " ", 
     RowBox[{
     "with", " ", "values", " ", "estimated", " ", "using", " ", "the", " ", 
      "analytical", " ", "probabilities"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
      "objFunAnalytic"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"nCells", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "2", ",", "2"}], "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
       "results"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"i", ".", "e", ".", " ", "nCells"}], " ", "=", " ", 
        RowBox[{"resVal", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2", ",", "1"}], "]"}], "]"}]}], ";"}]}], " ", 
     "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Probability", " ", "of", " ", "division", " ", "probDiv", " ", 
       "values", " ", "estimated", " ", "using", " ", "the", " ", 
       "analytical", " ", "probabilities"}], ",", " ", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
       "objFunAnalytic"}]}], " ", "*)"}], "\n", 
    RowBox[{"probDiv", "=", 
     RowBox[{"{", 
      RowBox[{"0.9189", ",", "0.7787", ",", "0.9553", ",", "0.902"}], "}"}]}],
     ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
       "results"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"i", ".", "e", ".", " ", "probDiv"}], " ", "=", " ", 
        RowBox[{"resVal", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}]}], " ", 
     "*)"}], "\n", 
    RowBox[{"simPatterned", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"\"\<simulations/heterogeneousModel/simPatterned\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.csv\>\""}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Get", " ", "the", " ", 
       RowBox[{"(", 
        RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", 
       " ", "for", " ", "a", " ", "mini"}], "-", 
      RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
     RowBox[{
      RowBox[{"with", " ", "s"}], "=", 
      RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
     RowBox[{"f", "=", 
      RowBox[{"number", " ", "of", " ", "labelled", " ", 
       RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"data", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqData", " ", "=", " ", 
     RowBox[{
      RowBox[{"computeFreqSF", "[", 
       RowBox[{"dataPatterned", ",", "pairOptions"}], "]"}], "*", "1."}]}], 
    ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"simulations", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqSim", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1.", "*", 
        RowBox[{"computeFreqSFPattern", "[", 
         RowBox[{
          RowBox[{"simPatterned", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", "1", ",", "pairOptions"}], 
         "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "the", " ", "stscked", " ", "plots", " ", "for", " ", 
     "each", " ", "pattern"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt1Alg", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "1", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt2Alg", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "2", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt3Alg", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "3", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt4Alg", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"freqSim", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "4", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Export", " ", "the", " ", "4", " ", "plots", " ", "in", " ", "pdf", " ", 
     "and", " ", "svg", " ", "formats"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt1.pdf\>\"", ",", 
      "plotStackedPatt1Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt1.svg\>\"", ",", 
      "plotStackedPatt1Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt2.pdf\>\"", ",", 
      "plotStackedPatt2Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt2.svg\>\"", ",", 
      "plotStackedPatt2Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt3.pdf\>\"", ",", 
      "plotStackedPatt3Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt3.svg\>\"", ",", 
      "plotStackedPatt3Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt4.pdf\>\"", ",", 
      "plotStackedPatt4Alg"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlotAlg_Patt4.svg\>\"", ",", 
      "plotStackedPatt4Alg"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.7874644669579625`*^9, 3.7874645263696012`*^9}, {
  3.7874645609606977`*^9, 3.787464597089012*^9}, {3.7874646465055294`*^9, 
  3.787464732349018*^9}, {3.787464772226631*^9, 3.78746496172738*^9}, {
  3.7874654682975826`*^9, 3.7874656100265408`*^9}, {3.787465697479477*^9, 
  3.7874657212322116`*^9}, {3.7874679878416443`*^9, 3.7874680135188613`*^9}, {
  3.7874680444483376`*^9, 3.787468070989992*^9}, {3.7874681200720563`*^9, 
  3.7874681531495066`*^9}, {3.787468285003358*^9, 3.787468289000535*^9}, {
  3.787468579267725*^9, 3.7874685843026304`*^9}, {3.7874686239907565`*^9, 
  3.7874686294597583`*^9}, {3.787478522081521*^9, 3.787478549900812*^9}, {
  3.78747858431107*^9, 3.787478611120149*^9}, {3.787479076868352*^9, 
  3.7874790845881476`*^9}, {3.7874792182085457`*^9, 3.787479222427493*^9}, {
  3.7874802614475636`*^9, 3.78748028930488*^9}, {3.7874811698097982`*^9, 
  3.7874811703098345`*^9}}],

Cell["11. Stacked plots (heterogeneous model, analytical approach)", "Program",
 CellChangeTimes->{{3.785744534818243*^9, 3.785744564737661*^9}, {
  3.785744628144597*^9, 3.785744631809021*^9}, {3.7874654161208563`*^9, 
  3.787465443668005*^9}, {3.787479319743933*^9, 3.787479323246496*^9}, {
  3.787483059195796*^9, 3.7874830597270775`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "the", " ", "labelling", " ", "efficiency", " ", "for", 
    " ", "each", " ", 
    RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"probLab", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"getLabelEfficiencyPattern", "[", 
        RowBox[{
         RowBox[{"dataPatterned", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Stem", " ", "cell", " ", "numbers"}], ",", " ", "nCells", ",", 
     " ", 
     RowBox[{
     "with", " ", "values", " ", "estimated", " ", "using", " ", "the", " ", 
      "analytical", " ", "probabilities"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
      "objFunAnalytic"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"nCells", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "2", ",", "2"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
      "results"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "nCells"}], " ", "=", " ", 
       RowBox[{"resVal", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2", ",", "1"}], "]"}], "]"}]}], ";"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Probability", " ", "of", " ", "division", " ", "probDiv", " ", "values",
       " ", "estimated", " ", "using", " ", "the", " ", "analytical", " ", 
      "probabilities"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "minimizing"}], " ", 
      "objFunAnalytic"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"probDiv", "=", 
     RowBox[{"{", 
      RowBox[{"0.9189", ",", "0.7787", ",", "0.9553", ",", "0.902"}], "}"}]}],
     ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "or", " ", "get", " ", "them", " ", "from", " ", "estimation", " ", 
       "results"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"i", ".", "e", ".", " ", "probDiv"}], " ", "=", " ", 
        RowBox[{"resVal", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}]}], " ", 
     "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Get", " ", "the", " ", 
        RowBox[{"(", 
         RowBox[{"s", ",", "f"}], ")"}], " ", "pair", " ", "possibilities", 
        " ", "for", " ", "a", " ", "mini"}], "-", 
       RowBox[{"arch", " ", "of", " ", "8", " ", "filaments"}]}], ",", " ", 
      RowBox[{
       RowBox[{"with", " ", "s"}], "=", 
       RowBox[{"number", " ", "of", " ", "switches"}]}], ",", " ", 
      RowBox[{"f", "=", 
       RowBox[{"number", " ", "of", " ", "labelled", " ", 
        RowBox[{"filaments", "."}]}]}]}], " ", "*)"}], "\n", 
    RowBox[{"pairOptions", " ", "=", " ", 
     RowBox[{"getSwitchesLabFilOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Get", " ", "all", " ", 
      RowBox[{"2", "^", "8"}], " ", "possible", " ", "mini"}], "-", 
     RowBox[{"arch", " ", "configurations"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"listFilDistr", " ", "=", " ", 
     RowBox[{"getFilConfigOptions", "[", "8", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "frequencies", " ", "of", " ", "observing", 
     " ", "each", " ", "pair", " ", 
     RowBox[{"(", 
      RowBox[{"s", ",", "f"}], ")"}], " ", "in", " ", "the", " ", 
     RowBox[{"data", "."}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"freqData", " ", "=", " ", 
     RowBox[{"computeFreqSF", "[", 
      RowBox[{"dataPatterned", ",", "pairOptions"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Compute", " ", "the", " ", "analytical", " ", "probabilities", " ", 
      "of", " ", "observing", " ", "a", " ", "pair", " ", 
      RowBox[{"(", 
       RowBox[{"s", ",", "f"}], ")"}]}], ",", " ", 
     RowBox[{
     "to", " ", "replace", " ", "the", " ", "frequencies", " ", "from", " ", 
      RowBox[{"simulations", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"probSF", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"computeProbSF", "[", 
        RowBox[{
         RowBox[{"nCells", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"probDiv", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"probLab", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "listFilDistr", ",", 
         "pairOptions"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "the", " ", "stscked", " ", "plots", " ", "for", " ", 
     "each", " ", "pattern"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt1", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"probSF", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "1", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt2", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"probSF", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "2", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt3", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"probSF", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "3", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"plotStackedPatt4", " ", "=", " ", 
     RowBox[{"plotStackedChartComparison", "[", 
      RowBox[{
       RowBox[{"freqData", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"probSF", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "colorSchemeBlue", ",", 
       RowBox[{"\"\<Pattern \>\"", "<>", 
        RowBox[{"ToString", "[", "4", "]"}], "<>", "\"\<: n = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"nCells", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<, p = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"probDiv", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", ".001"}], "]"}], "]"}]}], 
       ",", "barLegendSchemeBlue"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Export", " ", "the", " ", "4", " ", "plots", " ", "in", " ", "pdf", " ", 
     "and", " ", "svg", " ", "formats"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt1.pdf\>\"", ",", 
      "plotStackedPatt1"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt1.svg\>\"", ",", 
      "plotStackedPatt1"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt2.pdf\>\"", ",", 
      "plotStackedPatt2"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt2.svg\>\"", ",", 
      "plotStackedPatt2"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt3.pdf\>\"", ",", 
      "plotStackedPatt3"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt3.svg\>\"", ",", 
      "plotStackedPatt3"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt4.pdf\>\"", ",", 
      "plotStackedPatt4"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<plots/heterogeneousModel/StackedPlot_Patt4.svg\>\"", ",", 
      "plotStackedPatt4"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "not", " ", "an", " ", "initialization", " ", 
      "cell"}], ",", " ", 
     RowBox[{
     "so", " ", "it", " ", "is", " ", "only", " ", "individually", " ", 
      RowBox[{"run", "."}]}]}], " ", "*)"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.7874644669579625`*^9, 3.7874645263696012`*^9}, {
   3.7874645609606977`*^9, 3.787464597089012*^9}, {3.7874646465055294`*^9, 
   3.787464732349018*^9}, {3.787464772226631*^9, 3.78746496172738*^9}, {
   3.787465640421142*^9, 3.7874656937918067`*^9}, {3.7874682933277693`*^9, 
   3.787468332601692*^9}, 3.787468382657649*^9, {3.7874684906554813`*^9, 
   3.787468490796116*^9}, {3.787468568015994*^9, 3.7874686191780443`*^9}, {
   3.787468747718777*^9, 3.787468749961306*^9}, {3.787469177010855*^9, 
   3.787469178589049*^9}, {3.787469228325943*^9, 3.7874692356659775`*^9}, {
   3.7874707880947695`*^9, 3.787470866781718*^9}, {3.787470935994102*^9, 
   3.787470936319029*^9}, {3.7874785649327474`*^9, 3.787478579044256*^9}, {
   3.787479032426779*^9, 3.78747903887341*^9}, {3.787479189845316*^9, 
   3.7874792101669292`*^9}, {3.787480293196446*^9, 3.78748031976764*^9}, {
   3.7874811729974513`*^9, 3.7874811735443506`*^9}}]
},
WindowSize->{958, 967},
WindowMargins->{{47, Automatic}, {Automatic, 11}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 154, 2, 48, "Program"],
Cell[715, 24, 16447, 441, 1273, "Code",
 InitializationCell->False],
Cell[17165, 467, 214, 3, 48, "Program"],
Cell[17382, 472, 120534, 2784, 7173, "Code"],
Cell[137919, 3258, 170, 2, 48, "Program"],
Cell[138092, 3262, 2305, 53, 153, "Code"],
Cell[140400, 3317, 194, 2, 48, "Program"],
Cell[140597, 3321, 7847, 188, 533, "Code",
 InitializationCell->False],
Cell[148447, 3511, 187, 2, 48, "Program"],
Cell[148637, 3515, 10034, 219, 533, "Code",
 InitializationCell->False],
Cell[158674, 3736, 235, 3, 48, "Program"],
Cell[158912, 3741, 4856, 128, 313, "Code",
 InitializationCell->False],
Cell[163771, 3871, 239, 3, 48, "Program"],
Cell[164013, 3876, 7243, 163, 273, "Code",
 InitializationCell->False],
Cell[171259, 4041, 213, 3, 48, "Program"],
Cell[171475, 4046, 15889, 408, 1193, "Code",
 InitializationCell->False],
Cell[187367, 4456, 322, 4, 48, "Program"],
Cell[187692, 4462, 10715, 263, 793, "Code",
 InitializationCell->False],
Cell[198410, 4727, 352, 6, 48, "Program"],
Cell[198765, 4735, 11389, 282, 693, "Code",
 InitializationCell->False],
Cell[210157, 5019, 342, 4, 48, "Program"],
Cell[210502, 5025, 11178, 277, 673, "Code",
 InitializationCell->False]
}
]
*)

(* End of internal cache information *)
